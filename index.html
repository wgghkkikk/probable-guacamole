<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸ‘‘ Ø´Ø§Øª Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: Tahoma, Geneva, sans-serif; background: #222; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        #top-bar { background: #000; height: 40px; border-bottom: 2px solid #d4af37; display: flex; align-items: center; padding: 0 20px; color: #d4af37; font-weight: bold; justify-content: space-between; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø§Øª ÙˆØ§Ù„Ø£Ø³Ù…Ø§Ø¡ */
        #container { display: flex; flex: 1; overflow: hidden; background: #333; }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ (Ù…Ø«Ù„ Ø£Ù‡Ù„Ù†Ø§) */
        #user-list { width: 220px; background: #1a1a1a; border-left: 1px solid #444; overflow-y: auto; }
        .user-row { padding: 8px 15px; border-bottom: 1px solid #2a2a2a; display: flex; align-items: center; gap: 8px; font-size: 13px; }
        .user-row img { width: 20px; height: 20px; border-radius: 3px; }
        .king-name { color: #ffcc00; font-weight: bold; text-shadow: 1px 1px #000; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        #chat-window { flex: 1; display: flex; flex-direction: column; background: #fff; }
        #messages { flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; }

        /* Ø´ÙƒÙ„ Ø³Ø·Ø± Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ */
        .chat-line { margin-bottom: 5px; font-size: 14px; border-bottom: 1px dotted #ccc; padding-bottom: 3px; }
        .king-tag { color: #ff0000; font-weight: bold; }
        .time { color: #888; font-size: 11px; margin-left: 5px; }

        /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
        #footer { background: #f0f0f0; border-top: 2px solid #d4af37; padding: 10px; display: flex; gap: 10px; align-items: center; }
        #msg-input { flex: 1; padding: 10px; border: 1px solid #aaa; border-radius: 4px; outline: none; font-size: 14px; }
        .btn-send { background: linear-gradient(#d4af37, #8a6d3b); color: #000; border: 1px solid #000; padding: 8px 25px; cursor: pointer; font-weight: bold; }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #admin-panel { position: absolute; bottom: 70px; left: 10px; background: #fff; border: 2px solid #d4af37; padding: 15px; border-radius: 5px; display: none; box-shadow: 0 0 10px #000; }
    </style>
</head>
<body>

    <div id="top-bar">
        <span>ğŸ‘‘ Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ | Chat Alloush</span>
        <button onclick="toggleAdmin()" style="background:#d4af37; border:none; padding:2px 10px; cursor:pointer; font-weight:bold;">Ø§Ù„ØªØ­ÙƒÙ…</button>
    </div>

    <div id="container">
        <div id="user-list">
            <div style="background:#000; color:#fff; padding:5px; text-align:center; font-size:12px;">Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙˆÙ†</div>
            <div class="user-row">
                <img src="https://via.placeholder.com/20/gold/black?text=K">
                <span class="king-name">Ø¹Ù„ÙˆØ´ (Ø§Ù„Ù…Ù„Ùƒ)</span>
            </div>
        </div>

        <div id="chat-window">
            <div id="messages"></div>
        </div>
    </div>

    <div id="admin-panel">
        <button onclick="clearChat()" style="color:red; cursor:pointer;">ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
        <hr>
        <p style="font-size:11px; color:#666;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³ÙŠØ±ÙØ± Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ù„Ùƒ ÙÙ‚Ø·</p>
    </div>

    <div id="footer">
        <input type="text" id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">
        <button class="btn-send" onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://alloush-kingdom-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function sendMsg() {
            const input = document.getElementById('msg-input');
            if(input.value.trim() !== "") {
                db.ref("messages").push().set({
                    user: "Ø¹Ù„ÙˆØ´",
                    text: input.value,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                });
                input.value = "";
            }
        }

        db.ref("messages").limitToLast(50).on("child_added", (snapshot) => {
            const data = snapshot.val();
            const msgArea = document.getElementById('messages');
            const line = document.createElement('div');
            line.className = 'chat-line';
            line.innerHTML = `<span class="king-tag">(Ø§Ù„Ù…Ù„Ùƒ)</span> <span style="color:blue; font-weight:bold;">${data.user}:</span> <span style="color:#000;">${data.text}</span> <span class="time">${data.time}</span>`;
            msgArea.appendChild(line);
            msgArea.scrollTop = msgArea.scrollHeight;
        });

        function toggleAdmin() {
            const panel = document.getElementById('admin-panel');
            panel.style.display = panel.style.display === "none" ? "block" : "none";
        }

        function clearChat() {
            if(confirm("Ù…Ø³Ø­ Ø§Ù„Ø´Ø§ØªØŸ")) {
                db.ref("messages").remove();
                location.reload();
            }
        }

        document.getElementById('msg-input').onkeypress = (e) => { if(e.key === 'Enter') sendMsg(); };
    </script>
</body>
</html>
