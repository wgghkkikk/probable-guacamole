<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø¹Ù„ÙˆØ´ Ø§Ù„Ù…Ù„ÙƒÙŠØ© ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --gold: #ffd700; --bg: #0a0a0a; --panel: #161616; --accent: #1e1e1e; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-page { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .login-card { background: var(--panel); padding: 30px; border-radius: 20px; border: 1px solid var(--gold); width: 320px; text-align: center; }
        .login-card input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid #333; background: #222; color: white; box-sizing: border-box; }
        .login-card button { background: var(--gold); border: none; padding: 12px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .top-bar { height: 60px; background: var(--panel); border-bottom: 1px solid #222; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
        #main-box { display: flex; flex: 1; position: relative; }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side { width: 0; transition: 0.3s; background: var(--panel); overflow: hidden; white-space: nowrap; position: relative; z-index: 100; }
        .side.open { width: 260px; border-left: 1px solid #222; border-right: 1px solid #222; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .chat-view { flex: 1; display: flex; flex-direction: column; background: #0f0f0f; }
        #chat-msgs { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }

        /* ØªØµÙ…ÙŠÙ… Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø³ØªØ± Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .master-name {
            background: linear-gradient(90deg, #ffd700, #ffffff, #ffd700);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 2s linear infinite;
            font-weight: bold;
        }
        @keyframes shine { to { background-position: 200% center; } }

        /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø§Ø³ØªØ± ÙÙˆÙ‚ */
        .master-tools { display: flex; gap: 10px; font-size: 18px; }

        /* Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ ÙˆØ§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª */
        .profile-img { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--gold); margin-bottom: 10px; }
        .post { background: var(--accent); padding: 10px; border-radius: 10px; margin-bottom: 10px; font-size: 13px; border-right: 3px solid var(--gold); }

        /* Ø£Ø³ÙÙ„ Ø§Ù„Ø´Ø§Øª */
        .footer { padding: 15px; background: var(--panel); display: flex; gap: 10px; align-items: center; }
        #msg-in { flex: 1; background: #222; border: 1px solid #333; color: white; padding: 12px; border-radius: 25px; outline: none; }
        .plus-btn { background: #333; color: white; width: 40px; height: 40px; border-radius: 50%; border: none; font-size: 20px; cursor: pointer; }

        .btn-gold { color: var(--gold); cursor: pointer; font-size: 22px; }
    </style>
</head>
<body>

<div id="login-page">
    <div class="login-card">
        <h2 style="color:var(--gold)">Ø´Ø§Øª Ø¹Ù„ÙˆØ´ ğŸ‘‘</h2>
        <input type="text" id="u-name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
        <input type="password" id="u-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± (Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙÙ‚Ø·)">
        <button onclick="login()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©</button>
    </div>
</div>

<div class="top-bar">
    <div class="btn-gold" onclick="toggleSide('left')">â˜°</div>
    <div class="master-tools" id="m-tools" style="display:none;">
        <span onclick="alert('ØµØ§ÙØ±Ø© Ø§Ù†Ø°Ø§Ø±! ğŸ“¢')">ğŸ“¢</span>
        <span onclick="alert('Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø§Ù…! ğŸ“£')">ğŸ“£</span>
    </div>
    <div id="logo" class="master-name">CH-ALLOSH</div>
    <div class="btn-gold" onclick="toggleSide('right')">ğŸ‘¥</div>
</div>

<div id="main-box">
    <div id="side-right" class="side">
        <div style="padding: 20px;">
            <h4 style="color:var(--gold)">â— Ø§Ù„Ù…ØªØµÙ„ÙˆÙ† Ø§Ù„Ø¢Ù†</h4>
            <div id="online-users"></div>
        </div>
    </div>

    <div class="chat-view">
        <div id="chat-msgs"></div>
        <div class="footer">
            <button class="plus-btn" onclick="document.getElementById('fileIn').click()">+</button>
            <input type="file" id="fileIn" style="display:none">
            <input type="text" id="msg-in" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§...">
            <button onclick="sendMsg()" style="background:var(--gold); border:none; padding:10px 20px; border-radius:20px; font-weight:bold;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <div id="side-left" class="side">
        <div style="padding: 20px;">
            <div id="my-info" style="text-align:center;">
                <img src="https://via.placeholder.com/60" class="profile-img">
                <h3 id="display-name"></h3>
            </div>
            <hr style="border:0; border-top:1px solid #333;">
            <h4 style="color:var(--gold)">ğŸ“– Ø§Ù„ÙŠÙˆÙ…ÙŠØ§Øª (Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª)</h4>
            <div id="posts-area"></div>
        </div>
    </div>
</div>

<script>
    // Ø±Ø¨Ø· Firebase
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let myUser = { name: "", role: "Ø¹Ø¶Ùˆ" };

    function login() {
        let name = document.getElementById('u-name').value;
        let pass = document.getElementById('u-pass').value;
        if(!name) return;

        myUser.name = name;
        if(name === "Ø¹Ù„ÙˆØ´" && pass === "Allosh#King@2025") {
            myUser.role = "Ø§Ù„Ù…Ø§Ø³ØªØ±";
            document.getElementById('m-tools').style.display = 'flex';
        }

        document.getElementById('login-page').style.display = 'none';
        document.getElementById('display-name').innerText = name;
        initApp();
    }

    function toggleSide(s) {
        document.getElementById('side-'+s).classList.toggle('open');
    }

    function initApp() {
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙˆØ§Ø¬Ø¯
        db.ref('online/' + myUser.name).set(myUser);
        db.ref('online/' + myUser.name).onDisconnect().remove();

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†
        db.ref('online').on('value', snap => {
            let out = "";
            snap.forEach(u => {
                let d = u.val();
                out += `<div style="margin:10px 0" class="${d.role==='Ø§Ù„Ù…Ø§Ø³ØªØ±'?'master-name':''}">â— ${d.name}</div>`;
            });
            document.getElementById('online-users').innerHTML = out;
        });

        // Ø§Ù„Ø´Ø§Øª
        db.ref('messages').limitToLast(50).on('child_added', snap => {
            let d = snap.val();
            let area = document.getElementById('chat-msgs');
            let div = document.createElement('div');
            let isM = d.role === "Ø§Ù„Ù…Ø§Ø³ØªØ±";
            div.innerHTML = `<b class="${isM?'master-name':''}">${d.sender}:</b> ${d.content}`;
            area.appendChild(div);
            area.scrollTop = area.scrollHeight;
        });
    }

    function sendMsg() {
        let inpt = document.getElementById('msg-in');
        if(!inpt.value) return;
        db.ref('messages').push({ sender: myUser.name, role: myUser.role, content: inpt.value });
        inpt.value = "";
    }
</script>
</body>
</html>
