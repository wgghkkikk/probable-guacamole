<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>MASTER RG - Multi Pages</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --gold: #ffd700; --bg: #000; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Cairo', sans-serif; overflow: hidden; }

        /* Ø§Ù„ØµÙØ­Ø§Øª */
        .page { position: fixed; inset: 0; background: var(--bg); display: none; z-index: 10; }
        .page.active { display: block; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }

        /* Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØºØ±Ù (Ø§Ù„Ù„ÙˆØ¨ÙŠ) */
        #lobby { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .room-card { background: #111; width: 100%; max-width: 320px; padding: 25px; border-radius: 20px; border: 1px solid #333; margin-bottom: 20px; text-align: center; cursor: pointer; transition: 0.3s; }
        .room-card:active { transform: scale(0.95); border-color: var(--neon); }
        .room-card h2 { margin: 0; color: var(--neon); }
        .room-card p { font-size: 12px; color: #888; margin: 10px 0 0; }

        header { height: 60px; background: #111; border-bottom: 2px solid var(--neon); display: flex; justify-content: space-between; align-items: center; padding: 0 15px; }
        .chat-area { position: absolute; top: 60px; left: 0; right: 0; bottom: 80px; overflow-y: auto; padding: 10px; }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .msg { display: flex; margin-bottom: 15px; }
        .msg img { width: 40px; height: 40px; border-radius: 8px; border: 1.5px solid var(--neon); margin-left: 10px; }
        .user-n { font-size: 12px; color: var(--neon); font-weight: bold; }
        .user-t { background: #1a1a1a; padding: 8px 12px; border-radius: 12px; margin-top: 4px; display: inline-block; max-width: 85%; word-break: break-word; }

        .footer { position: absolute; bottom: 0; left: 0; right: 0; height: 80px; background: #111; display: flex; align-items: center; padding: 15px; border-top: 1px solid #222; }
        input { flex: 1; background: #000; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 10px; font-family: 'Cairo'; }
        .send-btn { background: var(--neon); color: #000; border: none; padding: 10px 15px; border-radius: 10px; margin-right: 10px; font-weight: bold; }

        /* Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ */
        #login-screen { position: fixed; inset: 0; background: #000; z-index: 1000; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .login-box { background: #111; padding: 30px; border-radius: 25px; border: 1px solid var(--neon); width: 100%; max-width: 320px; text-align: center; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-box">
        <h2 style="color:var(--neon);">Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© RG</h2>
        <input type="text" id="regName" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±..." style="width:100%; text-align:center;">
        <button onclick="entry()" style="width:100%; background:var(--neon); border:none; padding:12px; margin-top:20px; border-radius:10px; font-weight:bold;">Ø¯Ø®ÙˆÙ„ ğŸš€</button>
    </div>
</div>

<div id="lobby-page" class="page active" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <h1 style="color:var(--gold); margin-bottom: 30px;">Ø§Ø®ØªØ± Ø§Ù„ØºØ±ÙØ© ğŸ›</h1>
    
    <div class="room-card" onclick="openRoom('main', 'Ø¹Ø±Ø´ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©')">
        <h2>ğŸ‘‘ Ø¹Ø±Ø´ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©</h2>
        <p>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ù„Ø¬Ù…ÙŠØ¹</p>
    </div>

    <div class="room-card" onclick="openRoom('vip', 'Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ù…Ø§Ø³ØªØ±')">
        <h2 style="color:var(--gold);">ğŸ’ Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ù…Ø§Ø³ØªØ±</h2>
        <p>Ù„Ù„Ù…Ù„ÙˆÙƒ ÙˆÙƒØ¨Ø§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª ÙÙ‚Ø·</p>
    </div>

    <button onclick="localStorage.clear(); location.reload();" style="background:none; border:none; color:red; font-family:'Cairo';">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
</div>

<div id="chat-page" class="page">
    <header>
        <button onclick="goBack()" style="background:none; border:none; color:var(--neon); font-size:20px;">â”</button>
        <b id="room-name-display" style="color:var(--gold);"></b>
        <div style="width:30px"></div>
    </header>
    <div id="chat-messages" class="chat-area"></div>
    <div class="footer">
        <input type="text" id="msgInp" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§...">
        <button onclick="sendMsg()" class="send-btn">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let my = {
        n: localStorage.getItem('rg-n') || "",
        logged: localStorage.getItem('rg-logged') || "false"
    };

    let currentRoom = "";

    if(my.logged === "true") document.getElementById('login-screen').style.display = 'none';

    function entry() {
        let n = document.getElementById('regName').value;
        if(n.trim().length < 2) return alert("Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ±!");
        localStorage.setItem('rg-n', n);
        localStorage.setItem('rg-logged', "true");
        location.reload();
    }

    function openRoom(roomId, roomName) {
        if(roomId === 'vip' && !my.n.includes("Ø§Ù„Ù…Ø§Ø³ØªØ±")) return alert("Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙŠÙˆØ§Ù† Ù„Ù„Ù…Ù„ÙˆÙƒ ÙÙ‚Ø·! ğŸ’");
        
        currentRoom = roomId;
        document.getElementById('room-name-display').innerText = roomName;
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ¨ÙŠ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø§Øª
        document.getElementById('lobby-page').classList.remove('active');
        document.getElementById('chat-page').classList.add('active');
        
        document.getElementById('chat-messages').innerHTML = "";
        loadMessages();
    }

    function goBack() {
        document.getElementById('chat-page').classList.remove('active');
        document.getElementById('lobby-page').classList.add('active');
        db.ref('rooms/' + currentRoom).off(); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø±ÙˆÙ…
    }

    function sendMsg() {
        let t = document.getElementById('msgInp').value;
        if(t.trim()) {
            db.ref('rooms/' + currentRoom).push({ u: my.n, t: t, time: Date.now() });
            document.getElementById('msgInp').value = '';
        }
    }

    function loadMessages() {
        db.ref('rooms/' + currentRoom).limitToLast(40).on('child_added', snap => {
            let m = snap.val();
            let div = document.createElement('div');
            div.className = 'msg';
            div.innerHTML = `
                <img src="https://ui-avatars.com/api/?name=${m.u}&background=random">
                <div class="msg-body">
                    <div class="user-n">${m.u} ${m.u.includes("Ø§Ù„Ù…Ø§Ø³ØªØ±")?'ğŸ‘‘':''}</div>
                    <div class="user-t">${m.t}</div>
                </div>`;
            document.getElementById('chat-messages').appendChild(div);
            document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
        });
    }
</script>
</body>
</html>
