<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø´Ø§Øª Ø¹Ù„ÙˆØ´ - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§ ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { margin: 0; font-family: 'Cairo', sans-serif; background: #1a1a1a; color: white; }
        #chat-wrap { display: flex; height: 100vh; flex-direction: column; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        
        /* Ø±ØªØ¨Ø© Ø¹Ù„ÙˆØ´ Ø§Ù„Ù…Ù…ÙŠØ²Ø© */
        .master-rank { 
            background: linear-gradient(90deg, #ffd700, #ff8c00); 
            color: black; padding: 2px 10px; border-radius: 5px; font-weight: bold; font-size: 12px;
        }

        /* Ø®Ø§Ù†Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø«Ø§Ø¨ØªØ© */
        .footer { padding: 15px; background: #222; display: flex; gap: 10px; border-top: 2px solid #333; }
        input { flex: 1; padding: 12px; border-radius: 8px; border: none; outline: none; }
        button { background: #ffd700; border: none; padding: 0 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù„ÙŠ ØªØ¸Ù‡Ø± Ù„Ø¹Ù„ÙˆØ´ ÙÙ‚Ø· */
        #admin-menu {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #252525; border: 2px solid #ffd700; padding: 20px; border-radius: 15px;
            display: none; z-index: 100; text-align: center; width: 200px;
        }
    </style>
</head>
<body>

<div id="chat-wrap">
    <div id="messages"></div>
    <div class="footer">
        <input type="text" id="mInput" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ ÙŠØ§ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±...">
        <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
</div>

<div id="admin-menu">
    <h4 id="target-name">Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ</h4>
    <button onclick="kickUser()" style="background:red; color:white; width:100%; padding:10px; border:none; cursor:pointer;">Ø·Ø±Ø¯ Ù†Ù‡Ø§Ø¦ÙŠ â›”</button>
    <button onclick="document.getElementById('admin-menu').style.display='none'" style="margin-top:10px; background:none; color:gray; border:none;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    // Ø±Ø¨Ø· Ù…Ø´Ø±ÙˆØ¹Ùƒ
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    // --- Ø£Ù‡Ù… Ù†Ù‚Ø·Ø©: Ø§Ù„Ø§Ø³Ù… Ù„Ø§Ø²Ù… ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ù„ÙŠ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ± ---
    let myName = "Ø¹Ù„ÙˆØ´"; 
    let myRank = "Ø¹Ø¶Ùˆ";
    let selectedUser = "";

    // ÙØ­Øµ Ø±ØªØ¨ØªÙƒ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
    db.ref('master').on('value', (snap) => {
        if (snap.val() === myName) {
            myRank = "ØµØ§Ø­Ø¨ Ø§Ù„Ø´Ø§Øª";
            console.log("Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¹Ù„ÙˆØ´ØŒ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¬Ø§Ù‡Ø²Ø©! ğŸ‘‘");
        }
    });

    function sendMsg() {
        let text = document.getElementById('mInput').value;
        if(!text) return;
        db.ref('messages').push({
            u: myName,
            t: text,
            r: myRank
        });
        document.getElementById('mInput').value = "";
    }

    db.ref('messages').limitToLast(50).on('child_added', (snap) => {
        let m = snap.val();
        let div = document.createElement('div');
        div.innerHTML = `<span class="${m.r === 'ØµØ§Ø­Ø¨ Ø§Ù„Ø´Ø§Øª' ? 'master-rank' : ''}">${m.r}</span> <b>${m.u}:</b> ${m.t}`;
        // Ø¥Ø°Ø§ Ø¶ØºØ·Øª Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù… ÙˆØ£Ù†Øª Ø§Ù„Ù…Ø§Ø³ØªØ± ØªÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        div.onclick = () => {
            if(myRank === "ØµØ§Ø­Ø¨ Ø§Ù„Ø´Ø§Øª" && m.u !== myName) {
                selectedUser = m.u;
                document.getElementById('target-name').innerText = selectedUser;
                document.getElementById('admin-menu').style.display = 'block';
            }
        };
        document.getElementById('messages').appendChild(div);
        document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
    });

    function kickUser() {
        db.ref('actions/' + selectedUser).set('kick');
        alert("ØªÙ… Ø·Ø±Ø¯ " + selectedUser);
        document.getElementById('admin-menu').style.display = 'none';
    }
</script>
</body>
</html>
