<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ù„ÙŠØ§Ø±ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø© ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffd700; --vip: #00d4ff; --bg: #050505; --glass: rgba(255, 255, 255, 0.05); }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; -webkit-tap-highlight-color: transparent; outline: none; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; height: 100vh; overflow: hidden; }

        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ© Ù„ÙƒÙ„ Ø¹Ø¶Ùˆ */
        #main-bg { position: fixed; inset: 0; z-index: -1; background-size: cover; background-position: center; opacity: 0.3; transition: 0.5s; }

        .app { display: flex; flex-direction: column; height: 100%; position: relative; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .header { height: 65px; background: rgba(0,0,0,0.95); border-bottom: 2px solid var(--gold); display: flex; justify-content: space-between; align-items: center; padding: 0 15px; box-shadow: 0 0 20px rgba(255,215,0,0.3); z-index: 1000; }
        .room-tag { font-size: 10px; color: var(--gold); background: rgba(255,215,0,0.1); padding: 2px 8px; border-radius: 10px; border: 0.5px solid var(--gold); }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ±ÙŠÙ†Ø¯ Ø§Ù„ØµØ§Ø¹Ø¯ */
        .trend-bar { height: 35px; background: #000; border-bottom: 1px solid #222; display: flex; align-items: center; overflow: hidden; white-space: nowrap; font-size: 11px; }
        .trend-move { animation: marquee 15s linear infinite; color: var(--vip); }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        #chat-win { flex: 1; overflow-y: auto; padding: 15px 15px 220px 15px; display: flex; flex-direction: column; gap: 15px; scroll-behavior: smooth; }
        
        /* ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø·ÙˆØ±Ø© */
        .msg { max-width: 85%; padding: 12px; border-radius: 20px; position: relative; border: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(10px); animation: slideUp 0.3s ease; }
        .msg-me { align-self: flex-end; background: linear-gradient(135deg, #1a1a1a, #0a0a0a); border-right: 4px solid var(--gold); }
        .msg-other { align-self: flex-start; background: linear-gradient(135deg, #0d0d0d, #1a1a1a); border-left: 4px solid var(--vip); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø´Ø¹Ø© Ù„Ù„Ø£Ø³Ø§Ø·ÙŠØ± */
        .legend-frame { border: 2px solid var(--gold) !important; box-shadow: 0 0 15px var(--gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 5px var(--gold); } 50% { box-shadow: 0 0 20px var(--gold); } 100% { box-shadow: 0 0 5px var(--gold); } }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¯ ÙˆØ§Ù„Ù…Ù†Ø´Ù† */
        .reply-box { font-size: 10px; background: rgba(255,255,255,0.08); padding: 6px; border-radius: 8px; margin-bottom: 6px; border-right: 3px solid var(--gold); color: #ccc; }
        .mention { background: var(--gold) !important; color: #000 !important; font-weight: bold; padding: 0 4px; border-radius: 4px; }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© */
        .user-card { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #111; border: 2px solid var(--gold); border-radius: 25px; padding: 25px; width: 280px; text-align: center; z-index: 5000; display: none; box-shadow: 0 0 50px #000; }

        /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ */
        .input-area { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.95); border-top: 1px solid #333; padding: 15px; z-index: 1100; }
        .input-row { display: flex; align-items: center; gap: 10px; }
        #mInp { flex: 1; background: #151515; border: 1px solid #333; color: #fff; border-radius: 25px; padding: 12px 20px; font-size: 14px; }
        .send-btn { background: var(--gold); border: none; width: 50px; height: 50px; border-radius: 50%; font-size: 22px; cursor: pointer; transition: 0.3s; }
        .send-btn:active { transform: scale(0.9); }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙˆØ§Ù„Ø®Ø±Ø§Ø¦Ø· */
        .menu { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 4000; display: none; padding: 40px 20px; overflow-y: auto; }
        .show { display: block; }
        .card-btn { width: 100%; padding: 16px; background: #111; border: 1px solid #333; color: #fff; border-radius: 15px; margin-bottom: 12px; font-weight: bold; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .card-btn:hover { border-color: var(--gold); }

        /* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø£ØµÙˆØ§Øª */
        .bot-tag { background: var(--gold); color: #000; font-size: 8px; padding: 1px 4px; border-radius: 4px; margin-left: 5px; vertical-align: middle; }
    </style>
</head>
<body>

<div id="main-bg"></div>

<div class="app">
    <div class="header">
        <button onclick="openM('m-profile')" style="background:none; border:none; font-size:24px;">ğŸ‘¤</button>
        <div style="text-align:center;">
            <b style="color:var(--gold); letter-spacing: 1px;">Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø¹Ù„ÙˆØ´ ğŸ‘‘</b><br>
            <span class="room-tag" id="current-room-display">Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¹Ø§Ù…</span>
        </div>
        <button onclick="openM('m-rooms')" style="background:none; border:none; font-size:24px;">ğŸ¢</button>
    </div>

    <div class="trend-bar">
        <div class="trend-move" id="trend-text">ğŸ”¥ Ø§Ù„Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´ ÙŠØ±Ø­Ø¨ Ø¨ÙƒÙ… ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ù„ÙŠØ§Ø±ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.. ØªÙØ§Ø¹Ù„ Ù„ØªØ±Ø¨Ø­ Ù†Ù‚Ø§Ø· XP!</div>
    </div>

    <div id="chat-win"></div>

    <div class="input-area">
        <div id="reply-preview" style="display:none; color:var(--gold); font-size:11px; margin-bottom:8px; display:flex; justify-content:space-between;">
            <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ù„Ø©...</span>
            <b onclick="cancelReply()" style="color:red;">Ø¥Ù„ØºØ§Ø¡</b>
        </div>
        <div class="input-row">
            <button onclick="openM('m-store')" style="background:none; border:none; font-size:24px;">ğŸ›’</button>
            <input type="text" id="mInp" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ @Ù‡Ù†Ø§..." onkeydown="if(event.key==='Enter') doSend()">
            <button class="send-btn" onclick="doSend()">ğŸš€</button>
        </div>
    </div>
</div>

<div id="user-card" class="user-card">
    <img id="u-img" src="" style="width:90px; height:90px; border-radius:50%; border:3px solid var(--gold);">
    <h3 id="u-name" style="margin:10px 0;">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h3>
    <div id="u-rank" style="color:var(--gold); font-size:13px; font-weight:bold;">Ù…Ø­Ø§Ø±Ø¨ âš”ï¸</div>
    <div style="margin:15px 0; font-size:12px; color:#aaa;">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="u-xp" style="color:var(--gold)">0</span> XP</div>
    <button onclick="sendGift()" class="card-btn" style="justify-content:center; background:var(--gold); color:#000;">ğŸ Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø¯ÙŠØ© Ù†Ù‚Ø§Ø·</button>
    <button onclick="closeCard()" style="background:none; border:none; color:#555; margin-top:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="m-rooms" class="menu">
    <h2 style="text-align:center; color:var(--gold);">ğŸ¢ ØºØ±Ù Ø§Ù„Ù…Ù…Ù„ÙƒØ©</h2>
    <div class="card-btn" onclick="switchRoom('Ø¹Ø§Ù…')"><span>ğŸ  Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¹Ø§Ù…</span> <span>Ø¯Ø®ÙˆÙ„</span></div>
    <div class="card-btn" onclick="switchRoom('VIP')"><span>ğŸ‘‘ ØµØ§Ù„Ø© Ø§Ù„Ù…Ù„ÙˆÙƒ (VIP)</span> <span>+50XP</span></div>
    <div class="card-btn" onclick="switchRoom('games')"><span>ğŸ® Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</span> <span>Ù†Ø´Ø·</span></div>
    <button onclick="closeAll()" class="card-btn" style="background:#333; justify-content:center;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="m-store" class="menu">
    <h2 style="text-align:center; color:var(--vip);">ğŸ’° Ø§Ù„Ø¨Ù†Ùƒ ÙˆØ§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ</h2>
    <div class="card-btn" onclick="buyItem('gold_name', 100)"><span>âœ¨ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„Ù†ÙŠÙˆÙ†</span> <span>100 XP</span></div>
    <div class="card-btn" onclick="buyItem('verify', 200)"><span>âœ… ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨</span> <span>200 XP</span></div>
    <div class="card-btn" onclick="buyItem('bomb', 50)"><span>ğŸ’£ Ù‚Ù†Ø¨Ù„Ø© ØµÙ…Øª (Ù„Ø¯Ù‚ÙŠÙ‚Ø©)</span> <span>50 XP</span></div>
    <div style="padding:15px; background:rgba(0,255,0,0.05); border-radius:15px; text-align:center;">
        <small>ØªØ­ÙˆÙŠÙ„ Ù†Ù‚Ø§Ø· Ù„Ø¹Ø¶Ùˆ Ø¢Ø®Ø±</small><br>
        <input type="text" id="gift-id" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ" style="width:70%; padding:8px; margin-top:5px;">
        <input type="number" id="gift-amt" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·" style="width:25%; padding:8px;">
        <button onclick="transferXP()" style="width:100%; padding:10px; margin-top:5px; background:green; border:none; color:#fff; border-radius:5px;">ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¢Ù† ğŸ’¸</button>
    </div>
    <br>
    <button onclick="closeAll()" class="card-btn" style="background:#333; justify-content:center;">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
</div>

<div id="m-profile" class="menu">
    <center>
        <img id="my-p-img" src="https://api.dicebear.com/7.x/bottts/svg?seed=alosh" style="width:100px; height:100px; border-radius:50%; border:3px solid var(--gold); cursor:pointer;">
        <h2 id="my-p-name">Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ Ø¹Ù„ÙˆØ´</h2>
        <div id="my-p-lvl" style="color:var(--gold)">Level 1</div>
        <hr style="border:0.5px solid #222; margin:20px 0;">
        <input type="text" id="nameInput" placeholder="ØªØºÙŠÙŠØ± Ø§Ø³Ù…Ùƒ..." style="width:100%; padding:15px; background:#111; color:#fff; border:1px solid #333; border-radius:10px;">
        <div class="card-btn" style="margin-top:10px; position:relative;">
            ğŸ–¼ï¸ ØªØºÙŠÙŠØ± Ø®Ù„ÙÙŠØ© Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
            <input type="file" onchange="uploadBg(this)" style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </div>
        <button onclick="saveProfile()" class="card-btn" style="background:var(--gold); color:#000; justify-content:center; margin-top:20px;">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…</button>
        <div id="admin-panel" style="display:none; margin-top:20px; border:1px solid red; padding:10px; border-radius:10px;">
            <p style="color:red;">ğŸ›  Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±</p>
            <button onclick="clearChat()" style="background:red; color:#fff; border:none; padding:10px; width:100%; border-radius:5px;">ğŸ—‘ Ù…Ø³Ø­ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
        </div>
        <button onclick="closeAll()" class="card-btn" style="background:#333; justify-content:center; margin-top:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </center>
</div>

<script>
    // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Firebase) ---
    const firebaseConfig = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ ---
    let uID = localStorage.getItem('uID') || "U" + Math.floor(Math.random()*9999999);
    localStorage.setItem('uID', uID);
    
    let myData = JSON.parse(localStorage.getItem('myData')) || {
        n: "Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯", xp: 0, r: "user", color: "#fff", bg: "", verified: false
    };

    let currentRoom = "Ø¹Ø§Ù…";
    let replyData = null;

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ØªØ¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ---
    function getRankInfo(xp) {
        if(xp >= 1000) return {n: "Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø£Ø³Ø·ÙˆØ±ÙŠ ğŸ‘‘", c: "legend-frame", tag: "rank-king"};
        if(xp >= 500) return {n: "ÙˆØ²ÙŠØ± Ø§Ù„Ù…Ù…Ù„ÙƒØ© ğŸ“œ", c: "legend-frame", tag: "rank-vip"};
        if(xp >= 100) return {n: "ÙØ§Ø±Ø³ Ø£Ø³Ø·ÙˆØ±ÙŠ ğŸ", c: "", tag: "rank-pro"};
        return {n: "Ù…Ø­Ø§Ø±Ø¨ Ù…Ø¨ØªØ¯Ø¦ âš”ï¸", c: "", tag: "rank-new"};
    }

    // --- Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ---
    function doSend() {
        let inp = document.getElementById('mInp');
        let txt = inp.value.trim();
        if(!txt) return;

        // ÙØ­Øµ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©
        db.ref('quiz_ans').once('value', s => {
            if(s.val() && txt === s.val()) {
                myData.xp += 100;
                db.ref('msgs/'+currentRoom).push({ n: "Ø¨ÙˆØª Ø§Ù„Ù…Ù…Ù„ÙƒØ© ğŸ¤–", t: `ğŸ‰ ÙƒÙÙˆÙˆÙˆ! ${myData.n} Ø£Ø¬Ø§Ø¨ ØµØ­ ÙˆØ±Ø¨Ø­ 100 Ù†Ù‚Ø·Ø©!`, r: "bot" });
                db.ref('quiz_ans').remove();
            } else {
                myData.xp += 1; // Ø²ÙŠØ§Ø¯Ø© Ù†Ù‚Ø·Ø© Ù„ÙƒÙ„ Ø±Ø³Ø§Ù„Ø©
                db.ref('msgs/'+currentRoom).push({
                    uid: uID, n: myData.n, t: txt, xp: myData.xp,
                    color: myData.color, v: myData.verified,
                    reply: replyData,
                    time: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})
                });
            }
            saveLocal();
            cancelReply();
            inp.value = "";
        });
    }

    // --- Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ---
    db.ref('msgs').child(currentRoom).limitToLast(40).on('value', s => {
        let win = document.getElementById('chat-win');
        win.innerHTML = "";
        s.forEach(child => {
            let d = child.val();
            let rank = getRankInfo(d.xp || 0);
            let div = document.createElement('div');
            
            // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù…Ù†Ø´Ù†
            let content = d.t;
            if(content.includes("@" + myData.n)) {
                content = `<span class="mention">${content}</span>`;
                new Audio('https://www.soundjay.com/buttons/sounds/button-3.mp3').play();
            }

            div.className = `msg ${d.uid === uID ? 'msg-me' : 'msg-other'} ${rank.c}`;
            div.onclick = () => setReply(d.n, d.t);
            div.oncontextmenu = (e) => { e.preventDefault(); showUserCard(d.n, d.xp, d.uid); };

            div.innerHTML = `
                <div style="font-size:10px; margin-bottom:4px; display:flex; align-items:center;">
                    <b style="color:${d.color}">${d.n} ${d.v ? 'âœ…' : ''}</b>
                    <span style="font-size:8px; margin-right:5px; opacity:0.7;">[${rank.n}]</span>
                </div>
                ${d.reply ? `<div class="reply-box">â†©ï¸ ${d.reply.substring(0,30)}...</div>` : ''}
                <div style="word-break:break-word;">${content}</div>
                <div style="font-size:7px; text-align:left; margin-top:4px; opacity:0.5;">${d.time || ''}</div>
            `;
            win.appendChild(div);
        });
        win.scrollTop = win.scrollHeight;
    });

    // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© ---
    function switchRoom(r) {
        if(r === 'VIP' && myData.xp < 50) return alert("ØªØ­ØªØ§Ø¬ 50 Ù†Ù‚Ø·Ø© Ù„Ø¯Ø®ÙˆÙ„ ØµØ§Ù„Ø© Ø§Ù„Ù…Ù„ÙˆÙƒ!");
        currentRoom = r;
        document.getElementById('current-room-display').innerText = r === 'Ø¹Ø§Ù…' ? "Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¹Ø§Ù…" : (r === 'VIP' ? "ØµØ§Ù„Ø© Ø§Ù„Ù…Ù„ÙˆÙƒ" : "Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨");
        closeAll();
        location.reload(); // Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ù„Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    }

    function showUserCard(name, xp, id) {
        let card = document.getElementById('user-card');
        document.getElementById('u-name').innerText = name;
        document.getElementById('u-xp').innerText = xp;
        document.getElementById('u-rank').innerText = getRankInfo(xp).n;
        document.getElementById('u-img').src = `https://api.dicebear.com/7.x/bottts/svg?seed=${name}`;
        card.style.display = "block";
    }

    function setReply(n, t) { replyData = n + ": " + t; document.getElementById('reply-preview').style.display = "flex"; }
    function cancelReply() { replyData = null; document.getElementById('reply-preview').style.display = "none"; }

    function saveProfile() {
        let nn = document.getElementById('nameInput').value;
        if(nn) myData.n = nn;
        saveLocal();
        closeAll();
    }

    function uploadBg(input) {
        let reader = new FileReader();
        reader.onload = (e) => {
            myData.bg = e.target.result;
            document.getElementById('main-bg').style.backgroundImage = `url(${e.target.result})`;
            saveLocal();
        };
        reader.readAsDataURL(input.files[0]);
    }

    function saveLocal() {
        localStorage.setItem('myData', JSON.stringify(myData));
        document.getElementById('my-p-name').innerText = myData.n;
        document.getElementById('my-p-xp').innerText = myData.xp;
        document.getElementById('my-p-lvl').innerText = "Level " + (Math.floor(myData.xp/50)+1);
        if(myData.bg) document.getElementById('main-bg').style.backgroundImage = `url(${myData.bg})`;
        if(myData.r === 'admin') document.getElementById('admin-panel').style.display = "block";
    }

    // --- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³Ø±ÙŠØ© Ù„Ù„Ù…Ø§Ù„Ùƒ ---
    let longClickTimer;
    document.getElementById('my-p-img').onmousedown = () => {
        longClickTimer = setTimeout(() => {
            if(prompt("Ø±Ù…Ø² Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø§Ù„Ø³Ø±ÙŠ:") === "1234") {
                myData.r = "admin"; myData.n = "Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¹Ù„ÙˆØ´ ğŸ‘‘"; myData.verified = true;
                saveLocal(); location.reload();
            }
        }, 3000);
    };

    function buyItem(type, cost) {
        if(myData.xp < cost) return alert("Ù†Ù‚Ø§Ø·Ùƒ Ù„Ø§ ØªÙƒÙÙŠ!");
        myData.xp -= cost;
        if(type === 'gold_name') myData.color = var(--gold);
        if(type === 'verify') myData.verified = true;
        saveLocal();
        alert("Ù…Ø¨Ø±ÙˆÙƒ! ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙŠØ²Ø©.");
    }

    function openM(id) { closeAll(); document.getElementById(id).classList.add('show'); }
    function closeAll() { document.querySelectorAll('.menu').forEach(m => m.classList.remove('show')); }
    function closeCard() { document.getElementById('user-card').style.display = "none"; }

    saveLocal();
</script>
</body>
</html>
