<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALLOSH MEDIA V25 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --gold: #d4af37; --owner: #ff0055; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        body { background: #050505; color: white; overflow: hidden; height: 100vh; position: fixed; width: 100%; }

        .royal-nav { height: 60px; background: #000; border-bottom: 2px solid var(--gold); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; z-index: 2000; position: relative; }
        
        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .drawer { position: fixed; top: 60px; bottom: 80px; width: 280px; background: rgba(10,10,10,0.98); border: 1px solid var(--gold); transition: 0.4s; z-index: 1500; backdrop-filter: blur(10px); }
        #drawer-r { right: -285px; }
        #drawer-l { left: -285px; }
        .drawer.open { right: 0 !important; left: 0 !important; }

        /* Ø§Ù„Ø´Ø§Øª */
        #chat-view { position: absolute; top: 60px; bottom: 80px; width: 100%; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; }
        .msg-card { display: flex; gap: 10px; animation: slideIn 0.3s ease; }
        .u-img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--gold); object-fit: cover; }
        .bubble { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 15px; max-width: 80%; border: 1px solid rgba(255,255,255,0.1); }
        .sent-pic { max-width: 100%; border-radius: 10px; margin-top: 5px; border: 1px solid var(--gold); }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .footer { position: fixed; bottom: 0; width: 100%; height: 80px; background: #000; display: flex; align-items: center; padding: 0 15px; gap: 10px; border-top: 1px solid #1a1a1a; }
        #msg-in { flex: 1; height: 45px; background: #111; border: 1px solid #333; border-radius: 25px; color: white; padding: 0 15px; }
        .icon-btn { font-size: 24px; cursor: pointer; color: var(--gold); background: none; border: none; }
        
        /* Ù…Ø®ÙÙŠ Ù„Ù„Ø±ÙØ¹ */
        #file-input, #avatar-input { display: none; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="royal-nav">
    <div onclick="toggleD('drawer-l')" style="font-size:24px; cursor:pointer;">âš™ï¸</div>
    <div style="color:var(--gold); font-weight:900;">ALLOSH MEDIA V25</div>
    <div onclick="toggleD('drawer-r')" style="font-size:24px; cursor:pointer;">ğŸ‘¥</div>
</div>

<div id="drawer-r" class="drawer">
    <div style="padding:15px; color:var(--gold); border-bottom:1px solid #222;">Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†</div>
    <div id="user-list" style="padding:10px;"></div>
</div>

<div id="drawer-l" class="drawer">
    <div style="padding:20px; text-align:center;">
        <label for="avatar-input">
            <img id="my-display-pic" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:90px; height:90px; border-radius:50%; border:3px solid var(--gold); cursor:pointer; object-fit: cover;">
            <p style="font-size:10px; color:var(--gold); margin-top:5px;">Ø¥Ø¶ØºØ· Ù„ØªØºÙŠÙŠØ± ØµÙˆØ±ØªÙƒ ğŸ“·</p>
        </label>
        <input type="file" id="avatar-input" accept="image/*" onchange="updateMyAvatar(this)">
        <h3 id="my-name-display" style="margin-top:10px;">Ø¹Ù„ÙˆØ´</h3>
        <hr style="margin:20px 0; opacity:0.1;">
        <button onclick="clearChat()" style="width:100%; padding:10px; background:none; border:1px solid red; color:red; border-radius:10px;">Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Øª ğŸ§¹</button>
    </div>
</div>

<div id="chat-view"></div>

<div class="footer">
    <label for="file-input" class="icon-btn">ğŸ–¼ï¸</label>
    <input type="file" id="file-input" accept="image/*" onchange="sendPhoto(this)">
    <input type="text" id="msg-in" placeholder="Ø§ÙƒØªØ¨ Ø£Ùˆ Ø§Ø±ÙØ¹ ØµÙˆØ±Ø©..." onkeypress="if(event.key==='Enter') sendText()">
    <button class="icon-btn" onclick="sendText()" style="color:var(--gold)">ğŸš€</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    let me = {
        name: "Ø¹Ù„ÙˆØ´",
        avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"
    };

    function toggleD(id) { 
        document.querySelectorAll('.drawer').forEach(d => { if(d.id !== id) d.classList.remove('open'); });
        document.getElementById(id).classList.toggle('open'); 
    }

    // Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
    function updateMyAvatar(input) {
        if (input.files && input.files[0]) {
            let reader = new FileReader();
            reader.onload = function(e) {
                me.avatar = e.target.result;
                document.getElementById('my-display-pic').src = me.avatar;
                alert("ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¨Ù†Ø¬Ø§Ø­! âœ…");
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    // Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ù„Ù„Ø´Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
    function sendPhoto(input) {
        if (input.files && input.files[0]) {
            let reader = new FileReader();
            reader.onload = function(e) {
                db.ref('media_msgs').push({
                    user: me.name,
                    avatar: me.avatar,
                    type: 'image',
                    content: e.target.result
                });
            };
            reader.readAsDataURL(input.files[0]);
            input.value = ""; // ØªØµÙÙŠØ± Ø§Ù„Ø­Ù‚Ù„
        }
    }

    function sendText() {
        let input = document.getElementById('msg-in'); if(!input.value) return;
        db.ref('media_msgs').push({
            user: me.name,
            avatar: me.avatar,
            type: 'text',
            content: input.value
        });
        input.value = "";
    }

    db.ref('media_msgs').limitToLast(30).on('child_added', s => {
        let d = s.val();
        let view = document.getElementById('chat-view');
        let div = document.createElement('div');
        div.className = "msg-card";
        
        let contentHtml = d.type === 'image' 
            ? `<img src="${d.content}" class="sent-pic">` 
            : d.content;

        div.innerHTML = `
            <img src="${d.avatar}" class="u-img">
            <div class="bubble">
                <b style="color:var(--gold); font-size:12px;">${d.user}</b><br>
                ${contentHtml}
            </div>`;
        view.appendChild(div);
        view.scrollTop = view.scrollHeight;
    });

    function clearChat() { if(confirm("Ù…Ø³Ø­ Ø§Ù„Ø´Ø§ØªØŸ")) db.ref('media_msgs').remove(); }
</script>
</body>
</html>
