<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙØ®Ù…Ø© ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --gold: #ffd700; --bg: #050505; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        .admin-header { background: linear-gradient(90deg, #ffd700, #ffae00); color: black; padding: 10px; text-align: center; font-weight: bold; cursor: pointer; display: none; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); }

        .chat-container { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; background: radial-gradient(circle at center, #111 0%, #000 100%); }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .msg { padding: 12px 16px; border-radius: 20px; max-width: 75%; position: relative; line-height: 1.5; animation: pop 0.3s ease; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .msg.me { align-self: flex-end; background: #222; border: 1px solid #444; border-bottom-right-radius: 2px; }
        .msg.other { align-self: flex-start; background: #1a1a1a; border: 1px solid var(--gold); border-bottom-left-radius: 2px; }
        
        .u-info { font-size: 11px; color: var(--gold); font-weight: bold; display: flex; justify-content: space-between; margin-bottom: 5px; }
        .kick-btn { color: red; cursor: pointer; margin-right: 10px; font-size: 14px; font-weight: bold; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-bar { background: #111; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #222; }
        input { flex: 1; background: #000; border: 1px solid #333; color: white; padding: 12px; border-radius: 12px; outline: none; }
        button { background: var(--gold); border: none; padding: 0 20px; border-radius: 12px; font-weight: bold; cursor: pointer; }

        @keyframes pop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

    <div id="adm-head" class="admin-header" onclick="adminMenu()">âš–ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø¹Ù„ÙˆØ´</div>

    <div class="chat-container" id="chat"></div>

    <div class="input-bar">
        <input type="text" id="minp" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ø£Ùˆ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©...">
        <button onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>

<script>
    const config = {
        apiKey: "AIzaSyDpjqkb4U-RF71r_Zv3tHAV9wWWe2L3pEQ", 
        authDomain: "masterchat-f2da9.firebaseapp.com",
        databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com",
        projectId: "masterchat-f2da9"
    };
    firebase.initializeApp(config);
    const auth = firebase.auth();
    const db = firebase.database();

    auth.onAuthStateChanged(user => {
        if (user) {
            if(user.email === "rgrghh77@gmail.com") document.getElementById('adm-head').style.display = 'block';
            load();
        } else { window.location.href = "index.html"; }
    });

    function send() {
        const val = document.getElementById('minp').value.trim();
        if(val) {
            db.ref('msgs').push({
                u: auth.currentUser.email.split('@')[0],
                t: val,
                a: auth.currentUser.email === "rgrghh77@gmail.com",
                time: new Date().toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'})
            });
            document.getElementById('minp').value = '';
        }
    }

    function load() {
        const chat = document.getElementById('chat');
        db.ref('msgs').limitToLast(40).on('child_added', snap => {
            const d = snap.val();
            const id = snap.key;
            const isMe = d.u === auth.currentUser.email.split('@')[0];
            const isImg = d.t.match(/\.(jpeg|jpg|gif|png)$/) != null;
            
            let content = isImg ? `<img src="${d.t}" style="width:100%; border-radius:10px; margin-top:5px;">` : d.t;
            let kickIcon = (auth.currentUser.email === "rgrghh77@gmail.com") ? `<span class="kick-btn" onclick="deleteMsg('${id}')">Ã—</span>` : '';

            chat.innerHTML += `
                <div class="msg ${isMe ? 'me' : 'other'}">
                    <div class="u-info">
                        <span>${d.a ? 'ğŸ‘‘ ' : ''}@${d.u}</span>
                        ${kickIcon}
                    </div>
                    <div>${content}</div>
                    <div style="font-size:9px; opacity:0.5; margin-top:5px;">${d.time}</div>
                </div>`;
            chat.scrollTop = chat.scrollHeight;
        });
    }

    function deleteMsg(id) { if(confirm("Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŸ")) db.ref('msgs').child(id).remove().then(() => location.reload()); }

    function adminMenu() {
        const op = prompt("1: Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©\n2: ØªØºÙŠÙŠØ± Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±");
        if(op === "1" && confirm("Ù…ØªØ£ÙƒØ¯ØŸ")) db.ref('msgs').remove().then(() => location.reload());
    }
</script>
</body>
</html>
