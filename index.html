<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MASTER CONTROL V34 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --main: #ffd700; --bg: #000; --glass: rgba(255,255,255,0.05); }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; transition: 0.3s; }
        
        body { background: var(--bg); color: white; overflow: hidden; height: 100vh; position: fixed; width: 100%; }
        
        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© */
        #dynamic-bg { position: fixed; inset: 0; z-index: -2; background: radial-gradient(circle, #1a1a2e 0%, #000 100%); }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .nav-master { height: 75px; background: rgba(0,0,0,0.9); border-bottom: 2px solid var(--main); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; z-index: 2000; }
        .nav-master b { font-size: 20px; color: var(--main); text-shadow: 0 0 10px var(--main); }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side-ctrl { position: fixed; top: 75px; bottom: 85px; width: 280px; background: rgba(5,5,5,0.98); border: 1px solid var(--main); border-radius: 20px; z-index: 1500; backdrop-filter: blur(15px); padding: 20px; }
        #ctrl-r { right: -300px; }
        #ctrl-l { left: -300px; }
        .side-ctrl.active { right: 10px !important; left: 10px !important; }

        /* Ø§Ù„Ø´Ø§Øª */
        #chat-scroller { position: absolute; top: 75px; bottom: 85px; width: 100%; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .msg-box { display: flex; gap: 12px; animation: slideUp 0.3s ease; align-items: flex-end; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .pfp { width: 45px; height: 45px; border-radius: 12px; border: 2px solid var(--main); }
        .bubble { background: var(--glass); padding: 12px 18px; border-radius: 18px; max-width: 80%; border: 1px solid rgba(255,255,255,0.05); position: relative; }
        .king-msg { border: 1px solid var(--main); box-shadow: 0 0 10px rgba(255,215,0,0.2); background: rgba(255,215,0,0.05); }
        .whisper { border: 1px solid #ff00ff; color: #ff00ff; font-style: italic; }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø«ÙŠÙ… */
        .theme-btn { padding: 8px; border: 1px solid #333; background: none; color: white; border-radius: 8px; cursor: pointer; margin: 5px; font-size: 12px; }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-shelf { position: fixed; bottom: 0; width: 100%; height: 85px; background: #000; display: flex; align-items: center; padding: 0 15px; gap: 10px; border-top: 1px solid #111; z-index: 2000; }
        #input-main { flex: 1; height: 50px; background: #0d0d0d; border: 1px solid #222; border-radius: 15px; color: white; padding: 0 15px; }
        .btn-push { width: 50px; height: 50px; background: var(--main); border-radius: 15px; border: none; font-weight: 900; color: black; }
    </style>
</head>
<body>

<div id="dynamic-bg"></div>

<div class="nav-master">
    <button onclick="toggleSide('ctrl-l')" style="background:none; border:none; font-size:26px;">âš™ï¸</button>
    <b>ALLOSH MASTER V34</b>
    <button onclick="toggleSide('ctrl-r')" style="background:none; border:none; font-size:26px;">ğŸ‘¥</button>
</div>

<div id="ctrl-r" class="side-ctrl">
    <h3 style="color:var(--main); margin-bottom:15px;">Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ù…Ù„ÙˆÙƒ</h3>
    <div id="user-list"></div>
</div>

<div id="ctrl-l" class="side-ctrl">
    <div style="text-align:center;">
        <img id="my-avatar" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:90px; height:90px; border-radius:15px; border:2px solid var(--main); cursor:pointer;" onclick="document.getElementById('file-in').click()">
        <input type="file" id="file-in" hidden onchange="updatePfp(this)">
        <h3 style="margin:10px 0;">Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø¹Ù„ÙˆØ´</h3>
        <hr style="opacity:0.1; margin:15px 0;">
        <p style="font-size:12px; margin-bottom:10px;">ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø®Ù„ÙÙŠØ© ğŸ­</p>
        <button class="theme-btn" onclick="setBg('radial-gradient(circle, #1a1a2e 0%, #000 100%)')">Ù„ÙŠÙ„ÙŠ</button>
        <button class="theme-btn" onclick="setBg('linear-gradient(45deg, #200122 0%, #6f0000 100%)')">Ù…Ù„ÙƒÙŠ</button>
        <button class="theme-btn" onclick="setBg('linear-gradient(to top, #09203f 0%, #537895 100%)')">Ù‡Ø§Ø¯Ø¦</button>
        <button onclick="clearChat()" style="width:100%; padding:12px; background:rgba(255,0,0,0.1); border:1px solid red; color:red; border-radius:12px; margin-top:20px;">ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… ğŸ§¹</button>
    </div>
</div>

<div id="chat-scroller"></div>

<div class="bottom-shelf">
    <button onclick="location.reload()" style="background:none; border:none; font-size:24px;">ğŸ”„</button>
    <input type="text" id="input-main" placeholder="Ø£Ù…Ø±Ùƒ Ù…Ø·Ø§Ø¹ ÙŠØ§ Ø³ÙŠØ¯ÙŠ..." onkeypress="if(event.key==='Enter') push()">
    <button class="btn-push" onclick="push()">ğŸš€</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let user = { name: "Ø¹Ù„ÙˆØ´", avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png", king: true };

    function toggleSide(id) {
        document.querySelectorAll('.side-ctrl').forEach(s => { if(s.id !== id) s.classList.remove('active'); });
        document.getElementById(id).classList.toggle('active');
    }

    function setBg(grad) { document.getElementById('dynamic-bg').style.background = grad; }

    function updatePfp(input) {
        if(input.files[0]) {
            let r = new FileReader();
            r.onload = e => { user.avatar = e.target.result; document.getElementById('my-avatar').src = e.target.result; };
            r.readAsDataURL(input.files[0]);
        }
    }

    function push() {
        let i = document.getElementById('input-main'); if(!i.value) return;
        let isWhisper = i.value.startsWith('Ø³Ø± ');
        db.ref('master_v34').push({ u: user.name, t: i.value, a: user.avatar, k: user.king, w: isWhisper });
        i.value = "";
    }

    db.ref('master_v34').limitToLast(40).on('child_added', s => {
        let d = s.val();
        let sc = document.getElementById('chat-scroller');
        let div = document.createElement('div');
        div.className = "msg-box";
        div.innerHTML = `
            <img src="${d.a}" class="pfp">
            <div class="bubble ${d.k?'king-msg':''} ${d.w?'whisper':''}">
                <b style="color:var(--main); font-size:11px;">${d.u}</b><br>
                <span>${d.t}</span>
            </div>`;
        sc.appendChild(div);
        sc.scrollTop = sc.scrollHeight;
    });

    db.ref('presence_v34/'+user.name).set(true);
    db.ref('presence_v34/'+user.name).onDisconnect().remove();
    db.ref('presence_v34').on('value', s => {
        let l = document.getElementById('user-list'); l.innerHTML = "";
        s.forEach(u => { l.innerHTML += `<div style="padding:10px; border-bottom:1px solid #111;">ğŸ‘‘ ${u.key}</div>`; });
    });

    function clearChat() { if(confirm("Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ")) db.ref('master_v34').remove(); }
    document.getElementById('chat-scroller').onclick = () => document.querySelectorAll('.side-ctrl').forEach(s => s.classList.remove('active'));
</script>
</body>
</html>
