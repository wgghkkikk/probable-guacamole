<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Master | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <style>
        :root { --glow: #00f2ff; --bg: #0b0c10; --panel: #1f2833; --text: #c5c6c7; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Arial', sans-serif; }
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header { background: #000; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--glow); box-shadow: 0 0 15px var(--glow); }
        .logo { color: var(--glow); font-weight: bold; font-size: 20px; text-shadow: 0 0 10px var(--glow); }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .container { flex: 1; display: flex; overflow: hidden; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Ø§Ù„ØºØ±Ù) */
        aside { width: 250px; background: #000; border-left: 1px solid #333; display: flex; flex-direction: column; }
        .aside-header { padding: 15px; background: var(--panel); font-weight: bold; border-bottom: 1px solid #444; }
        .room-link { padding: 12px 20px; cursor: pointer; border-bottom: 1px solid #111; transition: 0.3s; }
        .room-link:hover, .room-link.active { background: var(--glow); color: #000; font-weight: bold; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        main { flex: 1; display: flex; flex-direction: column; background: #0b0c10; position: relative; }
        #chat-window { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        
        /* Ø´ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø© */
        .message { background: rgba(255,255,255,0.05); padding: 10px 15px; border-radius: 10px; border-right: 4px solid var(--glow); align-self: flex-start; max-width: 80%; }
        .message .user { color: var(--glow); font-weight: bold; font-size: 13px; margin-bottom: 5px; display: block; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ÙƒØªØ§Ø¨Ø© */
        .input-area { padding: 15px; background: #000; display: flex; gap: 10px; border-top: 1px solid #333; }
        input[type="text"] { flex: 1; padding: 12px; border-radius: 25px; border: 1px solid #444; background: #111; color: #fff; outline: none; }
        button.send { background: var(--glow); border: none; padding: 0 25px; border-radius: 25px; font-weight: bold; cursor: pointer; }

        /* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆØ§Ù„ØºØ±Ù) */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: var(--panel); padding: 30px; border-radius: 15px; width: 350px; border: 1px solid var(--glow); box-shadow: 0 0 20px var(--glow); }
        .modal-content h2 { margin-bottom: 20px; color: var(--glow); }
        .modal-content input { width: 100%; padding: 10px; margin-bottom: 15px; background: #000; border: 1px solid #444; color: #fff; }
        .btn-close { background: red; color: white; border: none; padding: 8px 15px; cursor: pointer; margin-top: 10px; border-radius: 5px; }

        /* Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) { aside { display: none; } aside.active { display: flex; position: absolute; right: 0; top: 60px; bottom: 0; z-index: 500; } }
    </style>
</head>
<body>

<header>
    <div onclick="toggleAside()" style="cursor:pointer;">â˜°</div>
    <div class="logo">Ø§Ù„Ø¨Ø±Ù†Ø³ Ø´Ø§Øª</div>
    <div onclick="showModal('profile-modal')" style="cursor:pointer;">ğŸ‘¤ Ù…Ù„ÙÙŠ</div>
</header>

<div class="container">
    <aside id="sidebar">
        <div class="aside-header">Ø§Ù„ØºØ±Ù Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
        <div id="rooms-container">
            <div class="room-link active" onclick="switchRoom('Ø§Ù„Ø¹Ø§Ù…Ø©', this)">Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø¹Ø§Ù…Ø©</div>
        </div>
        <button onclick="showModal('room-modal')" style="margin:10px; padding:10px; background:var(--glow); border:none; font-weight:bold; cursor:pointer;">â• Ø¥Ø¶Ø§ÙØ© ØºØ±ÙØ©</button>
    </aside>

    <main>
        <div id="chat-window"></div>
        <div class="input-area">
            <input type="text" id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">
            <button class="send" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </main>
</div>

<div id="profile-modal" class="modal">
    <div class="modal-content">
        <h2>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
        <input type="text" id="user-name-input" placeholder="ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù…...">
        <button onclick="saveProfile()" style="width:100%; padding:10px; background:var(--glow); border:none; font-weight:bold;">Ø­ÙØ¸</button>
        <button class="btn-close" onclick="hideModal('profile-modal')">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<div id="room-modal" class="modal">
    <div class="modal-content">
        <h2>Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©</h2>
        <input type="text" id="room-name-input" placeholder="Ø§Ø³Ù… Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©...">
        <button onclick="createNewRoom()" style="width:100%; padding:10px; background:var(--glow); border:none; font-weight:bold;">Ø¥Ù†Ø´Ø§Ø¡</button>
        <button class="btn-close" onclick="hideModal('room-modal')">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script>
    let currentUser = "Ø§Ù„Ù…Ø§Ø³ØªØ±";
    let activeRoom = "Ø§Ù„Ø¹Ø§Ù…Ø©";
    let chatData = { "Ø§Ù„Ø¹Ø§Ù…Ø©": [] }; // Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„ÙƒÙ„ ØºØ±ÙØ©

    function showModal(id) { document.getElementById(id).style.display = 'flex'; }
    function hideModal(id) { document.getElementById(id).style.display = 'none'; }
    function toggleAside() { document.getElementById('sidebar').classList.toggle('active'); }

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
    function sendMessage() {
        const input = document.getElementById('msg-input');
        if(!input.value.trim()) return;

        const msgObj = { user: currentUser, text: input.value };
        chatData[activeRoom].push(msgObj); // Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø·
        
        renderMessages();
        input.value = '';
    }

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØºØ±ÙØ© ÙØ¹Ù„ÙŠØ§Ù‹
    function switchRoom(roomName, element) {
        activeRoom = roomName;
        // ØªØ­Ø¯ÙŠØ« Ø´ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        document.querySelectorAll('.room-link').forEach(el => el.classList.remove('active'));
        element.classList.add('active');
        // ØªØ­Ù…ÙŠÙ„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        renderMessages();
        if(window.innerWidth < 768) toggleAside();
    }

    // Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
    function createNewRoom() {
        const nameInput = document.getElementById('room-name-input');
        const name = nameInput.value.trim();
        if(name && !chatData[name]) {
            chatData[name] = []; // ØªÙ‡ÙŠØ¦Ø© Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ù„ØºØ±ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            const roomDiv = document.createElement('div');
            roomDiv.className = 'room-link';
            roomDiv.innerText = name;
            roomDiv.onclick = function() { switchRoom(name, this); };
            document.getElementById('rooms-container').appendChild(roomDiv);
            hideModal('room-modal');
            nameInput.value = '';
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©
    function renderMessages() {
        const window = document.getElementById('chat-window');
        window.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Ø´Ø© Ø£ÙˆÙ„Ø§Ù‹
        
        chatData[activeRoom].forEach(msg => {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message';
            msgDiv.innerHTML = `<span class="user">${msg.user}</span>${msg.text}`;
            window.appendChild(msgDiv);
        });
        window.scrollTop = window.scrollHeight;
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
    function saveProfile() {
        const name = document.getElementById('user-name-input').value.trim();
        if(name) currentUser = name;
        hideModal('profile-modal');
    }

    // Ø¯Ø¹Ù… Ø²Ø± Enter
    document.getElementById('msg-input').onkeypress = (e) => { if(e.key === 'Enter') sendMessage(); };
</script>
</body>
</html>
