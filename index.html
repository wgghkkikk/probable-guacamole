<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ | Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --main: #ffd700; --bg: #0b0b0b; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        body { background: var(--bg); color: white; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen { width: 90%; max-width: 400px; background: #111; padding: 30px; border-radius: 20px; border: 2px solid var(--main); box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); text-align: center; }
        h2 { color: var(--main); margin-bottom: 20px; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; border-radius: 10px; color: white; outline: none; }
        .btn { width: 100%; padding: 12px; margin-top: 10px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-mail { background: var(--main); color: #000; }
        .btn-guest { background: #333; color: white; margin-top: 20px; border: 1px dashed var(--main); }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #chat-interface { display: none; width: 100%; height: 100vh; flex-direction: column; background: var(--bg); }
        .header { height: 60px; background: #000; border-bottom: 2px solid var(--main); display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="login-screen">
    <h2>Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø¹Ù„ÙˆØ´</h2>
    
    <div id="email-section">
        <input type="email" id="user-email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
        <input type="password" id="user-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button class="btn btn-mail" onclick="handleAuth('login')">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
        <button class="btn" style="background:none; color:var(--main); font-size:12px;" onclick="handleAuth('register')">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</button>
    </div>

    <hr style="border: 0.5px solid #333; margin: 20px 0;">

    <button class="btn btn-guest" onclick="enterAsGuest()">Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ²Ø§Ø¦Ø± ğŸ‘¤</button>
</div>

<div id="chat-interface">
    <div class="header">Ù…Ø±Ø­Ø¨Ø§Ù‹ <span id="display-name" style="color:var(--main); margin-right:5px;"></span> ğŸ™ï¸ğŸ‘‘</div>
    <div id="chat-flow" style="flex:1; overflow-y:auto; padding:20px;"></div>
    <button onclick="logout()" style="background:red; color:white; border:none; padding:10px;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</div>

<script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (Ø§Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
    const firebaseConfig = {
        databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com"
        // Ø£Ø¶Ù Ø§Ù„Ù€ API Key Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ Ù…Ù† Firebase Console Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    // 1. Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ (ØªØ³Ø¬ÙŠÙ„ ÙˆØ¯Ø®ÙˆÙ„)
    async function handleAuth(type) {
        const email = document.getElementById('user-email').value;
        const pass = document.getElementById('user-pass').value;
        
        try {
            if(type === 'register') {
                await auth.createUserWithEmailAndPassword(email, pass);
                alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­!");
            } else {
                await auth.signInWithEmailAndPassword(email, pass);
            }
            showChat(email.split('@')[0]);
        } catch (e) {
            alert("Ø®Ø·Ø£: " + e.message);
        }
    }

    // 2. Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø§Ø¦Ø±
    function enterAsGuest() {
        const guestName = "Ø²Ø§Ø¦Ø±_" + Math.floor(Math.random() * 9999);
        showChat(guestName);
    }

    // 3. ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
    function showChat(name) {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('chat-interface').style.display = 'flex';
        document.getElementById('display-name').innerText = name;
        // Ù‡Ù†Ø§ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø´Ø§Øª ÙˆØ§Ù„Ù…Ø§ÙŠÙƒØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    }

    function logout() {
        auth.signOut();
        location.reload();
    }
</script>
</body>
</html>
