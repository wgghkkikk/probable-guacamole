<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>COSMOS V30 | ALLOSH ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --gold: #ffcc00; --neon: #00ffcc; --royal: #6e00ff; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; outline: none; }
        
        body { background: #000; color: white; overflow: hidden; height: 100vh; position: fixed; width: 100%; }
        
        /* Ø®Ù„ÙÙŠØ© ÙƒÙˆÙ†ÙŠÙ‘Ø© */
        .cosmos-bg { position: fixed; inset: 0; background: radial-gradient(circle at bottom, #0d001a 0%, #000 100%); z-index: -2; }
        .stars { position: fixed; inset: 0; background: url('https://www.transparenttextures.com/patterns/stardust.png'); opacity: 0.3; z-index: -1; animation: rotateBg 200s linear infinite; }
        @keyframes rotateBg { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„Ø³ÙŠØ§Ø¯Ø© */
        .nav-crown { height: 75px; background: rgba(0,0,0,0.85); backdrop-filter: blur(15px); border-bottom: 2px solid var(--gold); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 2000; box-shadow: 0 5px 20px rgba(255, 204, 0, 0.2); }
        .nav-crown b { font-size: 22px; background: linear-gradient(45deg, #fff, var(--gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 10px var(--gold)); }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ù…Ø¨ØªÙƒØ±Ø© */
        .panel-cosmos { position: fixed; top: 75px; bottom: 90px; width: 290px; background: rgba(10, 0, 20, 0.95); border: 1px solid var(--gold); border-radius: 30px; transition: 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55); z-index: 1500; padding: 25px; visibility: hidden; opacity: 0; }
        #p-right { right: -320px; box-shadow: -10px 0 30px rgba(255, 204, 0, 0.1); }
        #p-left { left: -320px; box-shadow: 10px 0 30px rgba(0, 255, 204, 0.1); }
        .panel-cosmos.active { right: 15px !important; left: 15px !important; visibility: visible; opacity: 1; }

        /* Ø³Ø§Ø­Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠØ© */
        #chat-flow { position: absolute; top: 75px; bottom: 90px; width: 100%; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; }
        .msg-card { display: flex; gap: 15px; animation: entry 0.5s ease-out; }
        @keyframes entry { from { opacity: 0; transform: translateY(30px) scale(0.9); } to { opacity: 1; transform: translateY(0) scale(1); } }
        
        .avatar-wrap { position: relative; width: 55px; height: 55px; }
        .avatar-main { width: 100%; height: 100%; border-radius: 50%; border: 2px solid var(--gold); object-fit: cover; }
        .owner-aura { position: absolute; inset: -3px; border: 2px solid var(--neon); border-radius: 50%; animation: spin 4s linear infinite; border-top-color: transparent; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .bubble-cosmos { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); padding: 15px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); max-width: 75%; position: relative; }
        .owner-msg { border-right: 5px solid var(--gold); background: rgba(255, 204, 0, 0.05); }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø¥Ø­ØªØ±Ø§ÙÙŠ */
        .input-area { position: fixed; bottom: 15px; left: 15px; right: 15px; height: 65px; background: rgba(20, 20, 20, 0.9); border-radius: 25px; border: 1px solid var(--gold); display: flex; align-items: center; padding: 0 15px; gap: 12px; z-index: 2000; }
        #user-input { flex: 1; background: none; border: none; color: white; font-size: 16px; }
        .send-btn { width: 45px; height: 45px; background: var(--gold); border-radius: 18px; border: none; font-size: 20px; cursor: pointer; color: #000; transition: 0.3s; }
        .send-btn:hover { transform: scale(1.1) rotate(-10deg); }
    </style>
</head>
<body>

<div class="cosmos-bg"></div>
<div class="stars"></div>

<div class="nav-crown">
    <button onclick="toggleP('p-left')" style="background:none; border:none; font-size:28px;">ğŸ”±</button>
    <b>ALLOSH COSMOS V30</b>
    <button onclick="toggleP('p-right')" style="background:none; border:none; font-size:28px;">ğŸŒŸ</button>
</div>

<div id="p-right" class="panel-cosmos">
    <h3 style="color:var(--gold); margin-bottom:20px; border-bottom:1px solid #333;">Ù…Ù„ÙˆÙƒ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†</h3>
    <div id="online-users"></div>
</div>

<div id="p-left" class="panel-cosmos">
    <div style="text-align:center;">
        <div style="position:relative; width:110px; height:110px; margin:0 auto 15px;">
            <img id="my-pfp" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:100%; height:100%; border-radius:50%; border:3px solid var(--gold); object-fit:cover;">
            <div class="owner-aura"></div>
        </div>
        <input type="file" id="up-file" hidden onchange="updatePfp(this)">
        <button onclick="document.getElementById('up-file').click()" style="background:none; border:1px solid var(--gold); color:var(--gold); padding:5px 15px; border-radius:10px; font-size:12px;">ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø© ğŸ“·</button>
        <h2 style="margin-top:15px; color:#fff;">Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø¹Ù„ÙˆØ´</h2>
        <p style="color:var(--neon); font-size:11px;">Ø§Ù„Ø­Ø§Ù„Ø©: Ù…ÙØ³ÙŠØ·Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø´ âœ…</p>
        <hr style="margin:25px 0; opacity:0.1;">
        <button onclick="clearChat()" style="width:100%; padding:15px; background:rgba(255,0,0,0.1); border:1px solid red; color:red; border-radius:15px; font-weight:900;">ØªØ·Ù‡ÙŠØ± Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙƒÙˆÙ† ğŸ§¹</button>
    </div>
</div>

<div id="chat-flow"></div>

<div class="input-area">
    <button style="background:none; border:none; font-size:24px;">âœ¨</button>
    <input type="text" id="user-input" placeholder="Ø£Ù„Ù‚Ù ÙƒÙ„Ù…ØªÙƒ Ù‡Ù†Ø§..." onkeypress="if(event.key==='Enter') send()">
    <button class="send-btn" onclick="send()">ğŸš€</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let me = { name: "Ø¹Ù„ÙˆØ´", avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png", king: true };

    function toggleP(id) {
        document.querySelectorAll('.panel-cosmos').forEach(p => { if(p.id !== id) p.classList.remove('active'); });
        document.getElementById(id).classList.toggle('active');
    }

    function updatePfp(input) {
        if(input.files[0]) {
            let r = new FileReader();
            r.onload = e => { me.avatar = e.target.result; document.getElementById('my-pfp').src = e.target.result; };
            r.readAsDataURL(input.files[0]);
        }
    }

    function send() {
        let i = document.getElementById('user-input'); if(!i.value) return;
        db.ref('cosmos_v30').push({ u: me.name, t: i.value, a: me.avatar, k: me.king });
        i.value = "";
    }

    db.ref('cosmos_v30').limitToLast(40).on('child_added', s => {
        let d = s.val();
        let flow = document.getElementById('chat-flow');
        let div = document.createElement('div');
        div.className = "msg-card";
        div.innerHTML = `
            <div class="avatar-wrap">
                <img src="${d.a}" class="avatar-main">
                ${d.k ? '<div class="owner-aura"></div>' : ''}
            </div>
            <div class="bubble-cosmos ${d.k ? 'owner-msg' : ''}">
                <b style="color:var(--gold); font-size:12px;">${d.u}</b><br>
                <span style="font-size:15px; line-height:1.6;">${d.t}</span>
            </div>`;
        flow.appendChild(div);
        flow.scrollTop = flow.scrollHeight;
    });

    // Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨
    db.ref('presence_v30/'+me.name).set(true);
    db.ref('presence_v30/'+me.name).onDisconnect().remove();
    db.ref('presence_v30').on('value', s => {
        let list = document.getElementById('online-users'); list.innerHTML = "";
        s.forEach(u => { list.innerHTML += `<div style="padding:12px; border-bottom:1px solid #222; font-size:14px;">âš¡ ${u.key}</div>`; });
    });

    function clearChat() { if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„ÙƒÙˆÙ†ØŸ")) db.ref('cosmos_v30').remove(); }
    
    // Ø¥ØºÙ„Ø§Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Øª
    document.getElementById('chat-flow').onclick = () => { document.querySelectorAll('.panel-cosmos').forEach(p => p.classList.remove('active')); };
</script>
</body>
</html>
