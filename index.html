// Ù…ÙŠØ²Ø© 1: Ù…Ø­Ø±Ùƒ ØªÙŠÙƒ ØªÙˆÙƒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø´Ø§Ù…Ù„
let currentVideoPage = 1;

function openTikTok() {
    const display = document.getElementById('royal-display');
    display.style.display = 'block';
    
    // Ø¨Ù†Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙŠÙƒ ØªÙˆÙƒ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ
    document.getElementById('display-body').innerHTML = `
        <div id="tiktok-wrapper" style="height: 70vh; overflow-y: auto; scroll-snap-type: y mandatory; position: relative; background: #000; border-radius: 20px;">
            <div style="position: sticky; top: 0; z-index: 100; display: flex; padding: 10px; background: rgba(0,0,0,0.8); gap: 10px;">
                <input type="text" id="user-query" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ù„Ù…ØªØ§Ø¨Ø¹ØªÙ‡..." style="flex-grow:1; border-radius:20px; border:1px solid gold; background:#111; color:white; padding:8px 15px;">
                <button onclick="searchKingdomUser()" style="background:gold; border:none; border-radius:20px; padding:0 20px; cursor:pointer; font-weight:bold;">Ø¨Ø­Ø«</button>
            </div>

            <div id="video-stream"></div>
            
            <div id="scroll-anchor" style="height: 50px; text-align: center; color: gold; padding: 20px;">
                ... Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ù…Ù‚Ø§Ø·Ø¹ Ù…Ù„ÙƒÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© ...
            </div>
        </div>
    `;

    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠ
    const wrapper = document.getElementById('tiktok-wrapper');
    wrapper.addEventListener('scroll', () => {
        if (wrapper.scrollTop + wrapper.clientHeight >= wrapper.scrollHeight - 100) {
            appendNewVideos(); // ØªØ­Ù…ÙŠÙ„ Ù…Ù‚Ø§Ø·Ø¹ Ø¥Ø¶Ø§ÙÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        }
    });

    appendNewVideos(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
}

// Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ (Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ø³Ø­Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠØ©)
function appendNewVideos() {
    const stream = document.getElementById('video-stream');
    const demoVideos = [
        "https://www.w3schools.com/html/mov_bbb.mp4",
        "https://www.w3schools.com/html/horse.mp4"
    ];

    for(let i = 0; i < 3; i++) {
        let videoId = Math.random().toString(36).substr(2, 9);
        let videoDiv = document.createElement('div');
        videoDiv.className = 'video-post';
        videoDiv.style = "height: 100%; scroll-snap-align: start; position: relative; border-bottom: 2px solid #222;";
        
        videoDiv.innerHTML = `
            <video width="100%" height="100%" loop muted autoplay style="object-fit: cover;">
                <source src="${demoVideos[i%2]}" type="video/mp4">
            </video>
            
            <div style="position: absolute; right: 15px; bottom: 80px; display: flex; flex-direction: column; gap: 20px; align-items: center;">
                <div onclick="this.style.color='red'" style="font-size:30px; cursor:pointer;">â¤ï¸</div>
                <div onclick="openComments('${videoId}')" style="font-size:30px; cursor:pointer;">ğŸ’¬</div>
                <div onclick="followUser('${videoId}')" style="background:gold; color:black; border-radius:50%; width:35px; height:35px; display:flex; align-items:center; justify-content:center; font-weight:bold; cursor:pointer;">+</div>
            </div>

            <div style="position: absolute; bottom: 20px; left: 15px; text-shadow: 2px 2px 4px #000;">
                <h4 style="margin:0;">@Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±_Ø§Ù„Ù…Ù…Ù„ÙƒØ©_${Math.floor(Math.random()*1000)}</h4>
                <p style="margin:5px 0;">Ø­ØµØ±ÙŠØ§Ù‹ ÙÙŠ #Ù…Ù…Ù„ÙƒØ©_Ø¹Ù„ÙˆØ´ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© ğŸ‘‘</p>
            </div>
        `;
        stream.appendChild(videoDiv);
    }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø´Ø®Øµ Ù„Ù…ØªØ§Ø¨Ø¹ØªÙ‡
function searchKingdomUser() {
    const user = document.getElementById('user-query').value;
    if(user) {
        document.getElementById('video-stream').innerHTML = `
            <div style="text-align:center; padding:50px;">
                <div style="width:100px; height:100px; border-radius:50%; background:gold; margin:0 auto; display:flex; align-items:center; justify-content:center; color:black; font-size:40px;">ğŸ‘¤</div>
                <h3>${user}</h3>
                <button onclick="this.innerHTML='ØªÙ…Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© âœ”'; this.style.background='#444';" style="background:gold; border:none; padding:10px 40px; border-radius:20px; cursor:pointer; font-weight:bold;">Ù…ØªØ§Ø¨Ø¹Ø©</button>
                <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
                <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù‚Ø§Ø·Ø¹ ${user} Ø­ØµØ±ÙŠØ§Ù‹ Ù„Ùƒ...</p>
            </div>
        `;
        setTimeout(appendNewVideos, 1500);
    }
}
