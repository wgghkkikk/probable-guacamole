<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸ‘‘ Ø´Ø§Øª Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠ</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --gold: #d4af37; --bg: #050505; --panel: #111; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma; background: var(--bg); color: #fff; display: flex; height: 100vh; overflow: hidden; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø© */
        #sidebar { width: 280px; background: var(--panel); border-left: 2px solid var(--gold); display: flex; flex-direction: column; }
        .profile-card { padding: 30px 15px; text-align: center; border-bottom: 2px solid #222; background: linear-gradient(to bottom, #1a1a1a, #050505); }
        .user-pic { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--gold); box-shadow: 0 0 20px var(--gold); margin-bottom: 10px; cursor: pointer; }
        .king-name { font-size: 20px; font-weight: bold; color: var(--gold); text-shadow: 0 0 5px #000; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        #chat-main { flex-grow: 1; display: flex; flex-direction: column; position: relative; }
        header { padding: 15px 25px; background: #000; border-bottom: 2px solid var(--gold); display: flex; justify-content: space-between; align-items: center; }
        #messages-view { flex-grow: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; background-image: radial-gradient(#1a1a1a 1px, transparent 1px); background-size: 20px 20px; }

        /* Ø§Ù„ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .bubble { max-width: 70%; padding: 12px 18px; border-radius: 20px; font-size: 15px; position: relative; line-height: 1.5; }
        .king-bubble { align-self: flex-start; background: #1a1a1a; border-right: 4px solid var(--gold); color: var(--gold); font-weight: bold; border-top-right-radius: 2px; }
        .user-bubble { align-self: flex-end; background: #333; color: #fff; border-top-left-radius: 2px; }
        .meta { font-size: 10px; margin-bottom: 4px; opacity: 0.6; display: block; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© */
        #admin-box { position: absolute; top: 70px; right: 20px; background: #1a1a1a; border: 1px solid var(--gold); padding: 15px; border-radius: 12px; display: none; z-index: 100; width: 200px; }
        .adm-btn { width: 100%; padding: 10px; margin-bottom: 10px; background: #000; color: var(--gold); border: 1px solid var(--gold); cursor: pointer; font-weight: bold; border-radius: 5px; }
        .adm-btn:hover { background: var(--gold); color: #000; }

        /* Ø¨Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ */
        #send-bar { padding: 15px; background: #111; display: flex; gap: 10px; border-top: 2px solid #222; }
        #msg-in { flex-grow: 1; padding: 12px 20px; border-radius: 30px; border: 1px solid var(--gold); background: #000; color: #fff; outline: none; }
        .send-btn { background: var(--gold); color: #000; border: none; padding: 0 25px; border-radius: 30px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <aside id="sidebar">
        <div class="profile-card">
            <img src="https://via.placeholder.com/100/d4af37/000?text=Alloush" id="king-img" class="user-pic" title="Ø§Ø¶ØºØ· Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©">
            <div class="king-name">ğŸ‘‘ Ø¹Ù„ÙˆØ´ Ø§Ù„Ù…Ù„Ùƒ</div>
            <div style="font-size: 12px; color: #00ff00; margin-top: 5px;">â— Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</div>
        </div>
        <div style="padding: 20px;">
            <p style="color: var(--gold); font-size: 14px;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙŠÙ†:</p>
            <div id="online-list" style="font-size: 14px;">ğŸ‘‘ Ø¹Ù„ÙˆØ´ (Ø§Ù„Ù…Ù„Ùƒ)</div>
        </div>
    </aside>

    <main id="chat-main">
        <header>
            <div style="font-size: 22px; font-weight: bold; color: var(--gold);">Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´</div>
            <button onclick="toggleAdmin()" style="background:none; border:1px solid var(--gold); color:var(--gold); padding:5px 15px; border-radius:5px; cursor:pointer;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
        </header>

        <div id="messages-view"></div>

        <div id="admin-box">
            <button class="adm-btn" onclick="changeAvatar()">ğŸ–¼ï¸ ØªØºÙŠÙŠØ± ØµÙˆØ±ØªÙŠ</button>
            <button class="adm-btn" onclick="clearKingdom()" style="color: red; border-color: red;">ğŸ§¹ ØªØµÙÙŠØ± Ø§Ù„Ø´Ø§Øª</button>
        </div>

        <div id="send-bar">
            <input type="text" id="msg-in" placeholder="Ø£ØµØ¯Ø± Ù…Ø±Ø³ÙˆÙ…Ùƒ Ø§Ù„Ù…Ù„ÙƒÙŠ ÙŠØ§ Ø¹Ù„ÙˆØ´...">
            <button class="send-btn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„ âœ¨</button>
        </div>
    </main>

    <script>
        const firebaseConfig = { databaseURL: "https://alloush-kingdom-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function send() {
            const input = document.getElementById('msg-in');
            if(input.value.trim() !== "") {
                db.ref("messages").push().set({
                    user: "Ø¹Ù„ÙˆØ´",
                    text: input.value,
                    rank: "Ø§Ù„Ù…Ù„Ùƒ",
                    isKing: true,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                });
                input.value = "";
            }
        }

        db.ref("messages").limitToLast(40).on("child_added", (snapshot) => {
            const data = snapshot.val();
            const view = document.getElementById('messages-view');
            const div = document.createElement('div');
            div.className = `bubble ${data.isKing ? 'king-bubble' : 'user-bubble'}`;
            div.innerHTML = `<span class="meta">${data.user} (${data.rank}) â€¢ ${data.time}</span>${data.text}`;
            view.appendChild(div);
            view.scrollTop = view.scrollHeight;
        });

        function toggleAdmin() {
            const box = document.getElementById('admin-box');
            box.style.display = box.style.display === 'none' ? 'block' : 'none';
        }

        function changeAvatar() {
            const url = prompt("Ø£Ù„ØµÙ‚ Ø±Ø§Ø¨Ø· ØµÙˆØ±ØªÙƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ø±Ø¨Ø¹Ø©:");
            if(url) {
                document.getElementById('king-img').src = url;
                localStorage.setItem('alloush_pfp', url);
            }
        }

        function clearKingdom() {
            if(confirm("Ø³ÙŠØªÙ… Ù…Ø³Ø­ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŒ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ")) {
                db.ref("messages").remove();
                location.reload();
            }
        }

        window.onload = () => {
            if(localStorage.getItem('alloush_pfp')) document.getElementById('king-img').src = localStorage.getItem('alloush_pfp');
        };

        document.getElementById('msg-in').addEventListener('keypress', (e) => { if(e.key === 'Enter') send(); });
    </script>
</body>
</html>
