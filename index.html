<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALLOSH SMART THRONE V28 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --main: #d4af37; --bg: #050505; --accent: #ff0055; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; transition: 0.3s ease; }
        
        body { background: var(--bg); color: white; overflow: hidden; height: 100vh; position: fixed; width: 100%; }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ù…ØªØ³Ø§Ù‚Ø·Ø© */
        .particles { position: fixed; inset: 0; pointer-events: none; z-index: -1; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .top-nav { height: 70px; background: rgba(0,0,0,0.95); border-bottom: 2px solid var(--main); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; z-index: 2000; box-shadow: 0 0 20px rgba(212,175,55,0.2); }
        .crown-icon { font-size: 30px; filter: drop-shadow(0 0 10px var(--main)); cursor: pointer; }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .side-bar { position: fixed; top: 70px; bottom: 85px; width: 280px; background: rgba(10,10,10,0.98); border: 1px solid var(--main); z-index: 1500; backdrop-filter: blur(15px); }
        #side-r { right: -285px; border-radius: 20px 0 0 20px; }
        #side-l { left: -285px; border-radius: 0 20px 20px 0; }
        .side-bar.active { right: 0 !important; left: 0 !important; }

        /* Ø³Ø§Ø­Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        #chat-area { position: absolute; top: 70px; bottom: 85px; width: 100%; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 18px; }
        .msg-entry { display: flex; gap: 12px; align-items: flex-end; animation: fadeInUp 0.4s ease; }
        .pfp { width: 45px; height: 45px; border-radius: 12px; border: 2px solid var(--main); box-shadow: 0 0 10px rgba(212,175,55,0.3); }
        .txt-bubble { background: rgba(255,255,255,0.06); padding: 12px 16px; border-radius: 20px 20px 0 20px; max-width: 75%; position: relative; border: 1px solid rgba(255,255,255,0.05); }
        .owner-bubble { border-right: 4px solid var(--accent); background: rgba(255,0,85,0.05); text-shadow: 0 0 5px rgba(255,255,255,0.3); }
        .timestamp { font-size: 9px; color: #666; margin-top: 5px; display: block; text-align: left; }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-shelf { position: fixed; bottom: 0; width: 100%; height: 85px; background: #000; display: flex; align-items: center; padding: 0 15px; gap: 12px; border-top: 1px solid #111; z-index: 2000; }
        #text-in { flex: 1; height: 50px; background: #0a0a0a; border: 1px solid #222; border-radius: 15px; color: white; padding: 0 15px; font-size: 15px; }
        #text-in:focus { border-color: var(--main); box-shadow: 0 0 10px rgba(212,175,55,0.2); }
        .send-pill { padding: 10px 20px; background: var(--main); border: none; border-radius: 12px; font-weight: 900; cursor: pointer; color: black; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="top-nav">
    <div class="crown-icon" onclick="toggleMenu('side-l')">ğŸ‘¤</div>
    <div style="text-align:center">
        <div style="color:var(--main); font-weight:900; font-size:18px;">ALLOSH THRONE V28</div>
        <div id="online-tag" style="font-size:10px; color:#4caf50;">â— Ø§Ù„Ù†Ø¸Ø§Ù… Ù†Ø´Ø· ÙˆØ¨Ø§Ù†ØªØ¸Ø§Ø±Ùƒ</div>
    </div>
    <div class="crown-icon" onclick="toggleMenu('side-r')">ğŸ‘¥</div>
</div>

<div id="side-r" class="side-bar">
    <div style="padding:20px; color:var(--main); font-weight:900; border-bottom:1px solid #222;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ø¸Ù…Ø§Ø¡</div>
    <div id="users-list" style="padding:10px;"></div>
</div>

<div id="side-l" class="side-bar">
    <div style="padding:30px; text-align:center;">
        <img id="my-avatar" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" style="width:100px; height:100px; border:3px solid var(--main); border-radius:25px; cursor:pointer;" onclick="document.getElementById('img-upload').click()">
        <input type="file" id="img-upload" hidden accept="image/*" onchange="previewImg(this)">
        <h3 style="margin-top:10px;">Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø¹Ù„ÙˆØ´</h3>
        <button onclick="changeTheme()" style="margin-top:15px; width:100%; padding:10px; background:none; border:1px solid var(--main); color:var(--main); border-radius:10px;">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… ğŸ­</button>
        <button onclick="clearSystem()" style="margin-top:10px; width:100%; padding:10px; background:none; border:1px solid var(--accent); color:var(--accent); border-radius:10px;">ØªØ·Ù‡ÙŠØ± Ø§Ù„Ø¹Ø±Ø´ ğŸ§¹</button>
    </div>
</div>

<div id="chat-area"></div>

<div class="bottom-shelf">
    <button style="background:none; border:none; font-size:25px;" onclick="alert('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù…ØªØ¬Ø± Ø§Ù„Ø±Ù…ÙˆØ²')">ğŸ’</button>
    <input type="text" id="text-in" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø±Ø³ÙˆÙ…Ùƒ Ø§Ù„Ù…Ù„ÙƒÙŠ..." onkeypress="if(event.key==='Enter') pushData()">
    <button class="send-pill" onclick="pushData()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let user = { name: "Ø¹Ù„ÙˆØ´", avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png", isKing: true };

    function toggleMenu(id) {
        document.querySelectorAll('.side-bar').forEach(s => { if(s.id !== id) s.classList.remove('active'); });
        document.getElementById(id).classList.toggle('active');
    }

    function changeTheme() {
        const root = document.documentElement;
        const current = getComputedStyle(root).getPropertyValue('--main').trim();
        if(current === '#d4af37') {
            root.style.setProperty('--main', '#8a2be2');
            root.style.setProperty('--accent', '#00f2ff');
        } else {
            root.style.setProperty('--main', '#d4af37');
            root.style.setProperty('--accent', '#ff0055');
        }
    }

    function previewImg(input) {
        if(input.files[0]) {
            let reader = new FileReader();
            reader.onload = e => { user.avatar = e.target.result; document.getElementById('my-avatar').src = e.target.result; };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function pushData() {
        let input = document.getElementById('text-in');
        if(!input.value) return;
        let now = new Date();
        db.ref('throne_v28').push({
            u: user.name,
            t: input.value,
            a: user.avatar,
            k: user.isKing,
            time: now.getHours() + ":" + (now.getMinutes()<10?'0':'') + now.getMinutes()
        });
        input.value = "";
    }

    db.ref('throne_v28').limitToLast(40).on('child_added', s => {
        let d = s.val();
        let area = document.getElementById('chat-area');
        let div = document.createElement('div');
        div.className = "msg-entry";
        div.innerHTML = `
            <img src="${d.a}" class="pfp">
            <div class="txt-bubble ${d.k?'owner-bubble':''}">
                <b style="color:var(--main); font-size:12px;">${d.u}</b><br>
                <span>${d.t}</span>
                <span class="timestamp">${d.time}</span>
            </div>`;
        area.appendChild(div);
        area.scrollTop = area.scrollHeight;
    });

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ±
    db.ref('presence_v28/'+user.name).set(true);
    db.ref('presence_v28/'+user.name).onDisconnect().remove();
    db.ref('presence_v28').on('value', s => {
        let list = document.getElementById('users-list'); list.innerHTML = "";
        s.forEach(u => { list.innerHTML += `<div style="padding:12px; border-bottom:1px solid #111;">ğŸ‘‘ ${u.key}</div>`; });
    });

    function clearSystem() { if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ø±Ø´ØŸ")) db.ref('throne_v28').remove(); }

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¹Ù†Ø¯ Ù„Ù…Ø³ Ø§Ù„Ø´Ø§Ø´Ø©
    document.getElementById('chat-area').addEventListener('click', () => {
        document.querySelectorAll('.side-bar').forEach(s => s.classList.remove('active'));
    });
</script>
</body>
</html>
