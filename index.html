<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ | Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --king-gold: #d4af37; --dark-bg: #0f0f0f; --msg-bg: #1e1e1e; }
        body { background: var(--dark-bg); color: white; font-family: 'Cairo', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…) */
        #sidebar { 
            width: 280px; background: #141414; border-left: 2px solid var(--king-gold); 
            display: flex; flex-direction: column; transition: 0.3s; z-index: 1000;
        }
        .profile-area { padding: 20px; text-align: center; border-bottom: 1px solid #333; }
        .cover-box { width: 100%; height: 80px; background: var(--king-gold); border-radius: 10px; margin-bottom: -40px; background-size: cover; }
        .avatar-box { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--king-gold); background: #222; margin: 0 auto; position: relative; background-size: cover; }
        
        .admin-tools { padding: 20px; flex-grow: 1; }
        .admin-btn { 
            width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 8px; 
            border: 1px solid var(--king-gold); background: transparent; color: var(--king-gold); 
            cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        .admin-btn:hover { background: var(--king-gold); color: black; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        #main-chat { flex-grow: 1; display: flex; flex-direction: column; position: relative; }
        header { 
            background: #1a1a1a; padding: 15px; display: flex; justify-content: space-between; 
            align-items: center; border-bottom: 1px solid #333; box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        #messages-container { flex-grow: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .message { max-width: 80%; padding: 12px 18px; border-radius: 18px; position: relative; line-height: 1.5; font-size: 15px; }
        .msg-king { align-self: flex-start; background: linear-gradient(135deg, #d4af37, #8a6d3b); color: black; border-bottom-right-radius: 2px; box-shadow: 0 4px 12px rgba(212,175,55,0.3); font-weight: bold; }
        .msg-user { align-self: flex-end; background: #262626; color: white; border-bottom-left-radius: 2px; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-bar { padding: 20px; background: #1a1a1a; display: flex; gap: 10px; align-items: center; }
        input { flex-grow: 1; padding: 14px; border-radius: 25px; border: 1px solid #444; background: #222; color: white; outline: none; }
        .send-btn { background: var(--king-gold); border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 20px; }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) { #sidebar { position: absolute; right: -280px; height: 100%; } #sidebar.open { right: 0; } }
    </style>
</head>
<body>

    <aside id="sidebar">
        <div class="profile-area">
            <div id="cover-pic" class="cover-box"></div>
            <div id="avatar-pic" class="avatar-box"></div>
            <h3 style="margin-top:45px; color:var(--king-gold);">Ø§Ù„Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´</h3>
            <p style="font-size:12px; color:#888;">Ø§Ù„Ø±ØªØ¨Ø©: Ø§Ù„Ø­Ø§ÙƒÙ… Ø§Ù„Ø¹Ø¸ÙŠÙ…</p>
        </div>
        <div class="admin-tools">
            <button class="admin-btn" onclick="editProfile()">ğŸ–¼ï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
            <button class="admin-btn" onclick="clearKingdom()">ğŸ§¹ ØªØ·Ù‡ÙŠØ± Ø§Ù„Ø´Ø§Øª</button>
            <button class="admin-btn" onclick="toggleMode()">ğŸŒ™ ÙˆØ¶Ø¹ Ø§Ù„Ø¹ØªÙ…Ø©/Ø§Ù„Ù†ÙˆØ±</button>
            <div style="margin-top: 20px; font-size: 13px; color: #666;">
                Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†: <span id="online-count" style="color:var(--king-gold)">1</span>
            </div>
        </div>
    </aside>

    <main id="main-chat">
        <header>
            <button onclick="document.getElementById('sidebar').classList.toggle('open')" style="background:none; border:none; color:gold; font-size:24px; cursor:pointer;">â˜°</button>
            <div style="font-weight:bold; font-size:18px;">ğŸ‘‘ Ù…Ù€Ù…Ù€Ù„Ù€ÙƒÙ€Ø© Ø¹Ù€Ù„Ù€ÙˆØ´</div>
            <div style="width:30px;"></div>
        </header>

        <div id="messages-container"></div>

        <div class="input-bar">
            <input type="text" id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ù…Ø±Ø³ÙˆÙ…Ùƒ Ø§Ù„Ù…Ù„ÙƒÙŠ Ù‡Ù†Ø§...">
            <button class="send-btn" onclick="sendMessage()">ğŸ•Šï¸</button>
        </div>
    </main>

    <script>
        const firebaseConfig = { databaseURL: "https://alloush-kingdom-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        function sendMessage() {
            const input = document.getElementById('msg-input');
            if(input.value.trim() !== "") {
                db.ref("messages").push().set({
                    sender: "Ø¹Ù„ÙˆØ´",
                    text: input.value,
                    type: "king",
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                });
                input.value = "";
            }
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ
        db.ref("messages").limitToLast(30).on("child_added", (snapshot) => {
            const data = snapshot.val();
            const container = document.getElementById('messages-container');
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${data.type === 'king' ? 'msg-king' : 'msg-user'}`;
            msgDiv.innerHTML = `
                <div style="font-size:10px; opacity:0.7; margin-bottom:5px;">${data.sender} â€¢ ${data.time}</div>
                <div>${data.text}</div>
            `;
            container.appendChild(msgDiv);
            container.scrollTop = container.scrollHeight;
        });

        // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        function editProfile() {
            const cv = prompt("Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù (Ø§Ù„Ù…Ø±Ø¨Ø¹Ø©):");
            const av = prompt("Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© (Ø§Ù„Ù…ØµØºØ±Ø©):");
            if(cv) { document.getElementById('cover-pic').style.backgroundImage = `url(${cv})`; localStorage.setItem('king_cv', cv); }
            if(av) { document.getElementById('avatar-pic').style.backgroundImage = `url(${av})`; localStorage.setItem('king_av', av); }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        window.onload = () => {
            if(localStorage.getItem('king_cv')) document.getElementById('cover-pic').style.backgroundImage = `url(${localStorage.getItem('king_cv')})`;
            if(localStorage.getItem('king_av')) document.getElementById('avatar-pic').style.backgroundImage = `url(${localStorage.getItem('king_av')})`;
        };

        function clearKingdom() { if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù…Ù„ÙƒØ©ØŸ")) db.ref("messages").remove(); location.reload(); }
        
        // Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ§Ø± Ø¨Ø³ÙŠØ·
        setInterval(() => { document.getElementById('online-count').innerText = Math.floor(Math.random()*5)+1; }, 5000);
    </script>
</body>
</html>
