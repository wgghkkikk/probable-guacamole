<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸ‘‘ Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ù„ÙŠØ§Ø±ÙŠ ğŸ‘‘</title>
    <style>
        :root { --gold: #ffd700; --rainbow: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet); }
        body { margin: 0; background: #000; color: white; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; }

        /* 1. Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ÙƒÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø© */
        #star-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%); }
        .star { position: absolute; background: white; border-radius: 50%; animation: twinkle var(--duration) infinite; }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; transform: scale(1); } 50% { opacity: 1; transform: scale(1.2); } }

        /* 2. Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ø°ÙƒÙŠØ© ÙˆØ§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .side-panel { position: fixed; top: 70px; width: 230px; height: calc(100% - 180px); background: rgba(0,0,0,0.9); padding: 15px; z-index: 1000; border-radius: 15px; transition: 0.5s; border: 2px solid; animation: rainbow-border 3s linear infinite; }
        #users-panel { right: 10px; } #settings-panel { left: 10px; }
        .panel-hidden { transform: scaleX(0); opacity: 0; pointer-events: none; }
        #king-counter { text-align: center; color: var(--gold); background: rgba(255,215,0,0.1); border: 1px solid var(--gold); border-radius: 10px; padding: 10px; margin-bottom: 15px; font-weight: bold; }

        /* 3. Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø§Ù„Ù…Ø´Ø¹Ø© */
        #royal-clock { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); padding: 5px 25px; border-radius: 50px; z-index: 3000; background: rgba(0,0,0,0.8); font-weight: bold; border: 2px solid; animation: rainbow-border 3s linear infinite; font-size: 22px; }

        /* 4. Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø¹ ÙˆØ§Ù„Ø¨Ø³Ø§Ø· Ø§Ù„Ø£Ø­Ù…Ø± ÙˆØ§Ù„Ù„Ø§ÙˆØ§Øª */
        .royal-carpet { background: linear-gradient(90deg, transparent, rgba(139,0,0,0.9), transparent); border-top: 1px solid var(--gold); border-bottom: 1px solid var(--gold); padding: 15px; margin: 10px 0; position: relative; overflow: hidden; }
        .royal-name { font-weight: bold; background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-size: 400%; animation: rainbow-flow 3s linear infinite; }
        @keyframes rainbow-flow { 0% { background-position: 0%; } 100% { background-position: 100%; } }
        @keyframes rainbow-border { 0%, 100% { border-color: red; box-shadow: 0 0 15px red; } 50% { border-color: blue; box-shadow: 0 0 25px blue; } }

        /* 5. Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§Ù„Ø²Ø± Ø§Ù„Ù…Ù‚Ù„ÙˆØ¨ */
        .input-area { position: fixed; bottom: 0; width: 100%; display: flex; flex-direction: row-reverse; background: rgba(0,0,0,0.9); padding: 15px; gap: 10px; z-index: 3000; border-top: 2px solid; animation: rainbow-border 3s linear infinite; }
        #msg-in { flex: 1; padding: 12px; border-radius: 25px; background: #111; color: white; border: 1px solid var(--gold); outline: none; text-align: right; }
        #send-btn { transform: scaleX(-1); background: linear-gradient(45deg, #8b0000, #ff0000); color: gold; border: 2px solid gold; padding: 10px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; }
        
        /* 6. ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£ÙƒØ´Ù† (Ø²Ù„Ø²Ø§Ù„ ÙˆØ¨Ø±Ù‚) */
        #flash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; z-index: 10000; pointer-events: none; }
        .flash-active { animation: flash-anim 0.4s; }
        .shake-active { animation: shake 0.5s; }
        @keyframes flash-anim { 0%, 100% { opacity: 0; } 50% { opacity: 0.8; } }
        @keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-3px, -2px); } }
    </style>
</head>
<body onload="initKingdom()">
    <div id="star-container"></div>
    <div id="flash"></div>
    <div id="royal-clock">ğŸ•’ 00:00:00</div>

    <div id="users-panel" class="side-panel">
        <div id="king-counter">ğŸ‘¥ Ø§Ù„Ø±Ø¹ÙŠØ©: <span id="online-count">0</span></div>
        <h3 style="text-align:center; color:var(--gold);">ğ“†© Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† ğ“†ª</h3>
        <div id="user-list"></div>
    </div>
    
    <div id="settings-panel" class="side-panel">
        <h3 style="text-align:center; color:var(--gold);">ğ“†© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ğ“†ª</h3>
        <button style="width:100%; padding:10px; background:#222; color:gold; border:1px solid gold; cursor:pointer;" onclick="alert('Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ùƒ Ù…ÙØ¹Ù„Ø©!')">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ù„ÙƒÙŠ ğŸ›¡ï¸</button>
    </div>

    <div id="chat-container" style="margin: 0 250px; height: 100vh; display: flex; flex-direction: column; justify-content: flex-end;">
        <div id="messages" style="overflow-y: auto; padding: 20px; margin-bottom: 100px;"></div>
        
        <div class="input-area">
            <button id="send-btn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„ âŸ¸</button>
            <input type="text" id="msg-in" placeholder="Ù€ï®©ï®©Ù¨ï®©ï®©ğŸ‘‘ Ù…Ø±Ø³ÙˆÙ… Ø§Ù„Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´ ğŸ‘‘ï®©ï®©Ù¨ï®©ï®©Ù€" onfocus="toggleWings(false)" onblur="if(this.value=='') toggleWings(true)">
            <button onclick="toggleEmoji()" style="background:none; border:1px solid gold; color:gold; border-radius:50%; width:40px; cursor:pointer;">ğŸ˜Š</button>
        </div>
    </div>

    <script>
        function initKingdom() {
            setInterval(() => { document.getElementById('royal-clock').innerText = "ğŸ•’ " + new Date().toLocaleTimeString('en-GB'); }, 1000);
            createStars();
            // Ù‡Ù†Ø§ ÙŠØªÙ… Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Firebase Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø¹ÙŠØ© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
        }

        function createStars() {
            const container = document.getElementById('star-container');
            for (let i = 0; i < 120; i++) {
                const s = document.createElement('div'); s.className = 'star';
                s.style.width = s.style.height = Math.random()*3+'px';
                s.style.left = Math.random()*100+'vw'; s.style.top = Math.random()*100+'vh';
                s.style.setProperty('--duration', Math.random()*3+2+'s');
                container.appendChild(s);
            }
        }

        function toggleWings(show) {
            const panels = document.querySelectorAll('.side-panel');
            const chat = document.getElementById('chat-container');
            panels.forEach(p => p.classList.toggle('panel-hidden', !show));
            chat.style.margin = show ? "0 250px" : "0 20px";
        }

        function send() {
            const inp = document.getElementById('msg-in');
            if(inp.value.trim()) {
                renderMessage({u: "Ø¹Ù„ÙˆØ´", t: "ê§ " + inp.value + " ê§‚"});
                triggerEffects();
                inp.value = ""; toggleWings(true);
            }
        }

        function triggerEffects() {
            document.getElementById('flash').classList.add('flash-active');
            document.body.classList.add('shake-active');
            new Audio('https://www.soundjay.com/nature/thunder-storm-01.mp3').play().catch(e=>{});
            setTimeout(() => { document.getElementById('flash').classList.remove('flash-active'); document.body.classList.remove('shake-active'); }, 1000);
        }

        function renderMessage(d) {
            const box = document.getElementById('messages');
            const div = document.createElement('div');
            div.className = 'line royal-carpet';
            div.innerHTML = `<b class="royal-name">ğ“†© ğŸ‘‘ ${d.u} ğ“†ª:</b> <span>${d.t}</span>`;
            box.appendChild(div); box.scrollTop = box.scrollHeight;
        }
    </script>
</body>
</html>
