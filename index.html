<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´ Ù„Ù„Ø¯Ø±Ø¯Ø´Ø© ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { background: #000; color: #ffd700; font-family: sans-serif; margin: 0; padding: 20px; text-align: center; }
        .container { max-width: 400px; margin: auto; background: #111; padding: 20px; border-radius: 15px; border: 2px solid #ffd700; }
        input { width: 80%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none; }
        button { padding: 10px 20px; background: #ffd700; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #chat-box { height: 300px; overflow-y: auto; background: #222; margin: 20px 0; padding: 10px; text-align: right; border-radius: 10px; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="auth-section" class="container">
        <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù…Ù„ÙƒØ© ğŸ‘‘</h2>
        <input type="email" id="email" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„">
        <input type="password" id="pass" placeholder="Ø§Ù„Ø±Ù…Ø²">
        <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
        <p id="msg"></p>
    </div>

    <div id="chat-section" class="container hidden">
        <h2>ØºØ±ÙØ© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© ğŸ’¬</h2>
        <div id="chat-box"></div>
        <input type="text" id="user-msg" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
        <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
        <button onclick="firebase.auth().signOut()" style="background:red; color:white; margin-top:10px;">Ø®Ø±ÙˆØ¬</button>
    </div>

<script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ masterchat-f2da9 Ù…Ù† ØµÙˆØ±Ùƒ
    const config = {
        apiKey: "AIzaSyDnigkb4U-RE71r_Zy3tHAV9wWWe2L3nFQ",
        authDomain: "masterchat-f2da9.firebaseapp.com",
        databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com",
        projectId: "masterchat-f2da9"
    };
    firebase.initializeApp(config);

    const auth = firebase.auth();
    const db = firebase.database();

    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    auth.onAuthStateChanged(user => {
        if (user) {
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('chat-section').classList.remove('hidden');
            loadMessages();
        } else {
            document.getElementById('auth-section').classList.remove('hidden');
            document.getElementById('chat-section').classList.add('hidden');
        }
    });

    function login() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        auth.signInWithEmailAndPassword(e, p).catch(() => auth.createUserWithEmailAndPassword(e, p));
    }

    function sendMsg() {
        const text = document.getElementById('user-msg').value;
        if(text) {
            db.ref('messages').push({
                user: auth.currentUser.email,
                text: text,
                time: Date.now()
            });
            document.getElementById('user-msg').value = '';
        }
    }

    function loadMessages() {
        db.ref('messages').on('child_added', snap => {
            const data = snap.val();
            const div = document.createElement('div');
            div.innerHTML = `<small>${data.user}</small><br>${data.text}<hr>`;
            document.getElementById('chat-box').appendChild(div);
            document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
        });
    }
</script>
</body>
</html>
