// --- Ù†Ø¸Ø§Ù… ØªØ¹Ù‚Ø¨ Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ ---
const visitorInfo = {
    ua: navigator.userAgent,
    time: new Date().toLocaleString('ar-EG'),
    platform: navigator.platform
};

// Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù‚Ø§Ø¹Ø¯Ø©
function trackVisitor() {
    const myName = document.getElementById('my-name').value || "Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯";
    db.ref("activity_log").push().set({
        event: "Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ù…Ù„ÙƒØ©",
        user: myName,
        details: visitorInfo.ua,
        time: visitorInfo.time
    });

    // Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¨Ø§Ø´Ø± Ø¨Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    db.ref("messages").push().set({
        u: "ğŸ“¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù…Ù„ÙƒØ©",
        t: `Ø¯Ø®Ù„ Ø§Ù„Ù…Ù„Ùƒ ${myName} Ø§Ù„Ø¢Ù† Ø¥Ù„Ù‰ Ø§Ù„Ù‚ØµØ±.. Ø§Ø¶Ø±Ø¨ÙˆØ§ Ø³Ù„Ø§Ù…!`,
        s: {c: '#00ff00', a: 'neon-glow'},
        type: 'text',
        time: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})
    });
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
window.onload = () => {
    trackVisitor();
};

// --- Ø¥Ø¶Ø§ÙØ© Ø²Ø± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø³Ø¬Ù„ ---
function viewLogs() {
    db.ref("activity_log").limitToLast(10).once("value", (snap) => {
        let logs = "ğŸ“œ Ø³Ø¬Ù„ Ø¢Ø®Ø± Ø§Ù„Ø²ÙˆØ§Ø±:\n\n";
        snap.forEach(child => {
            const data = child.val();
            logs += `ğŸ‘¤ ${data.user} | â° ${data.time}\n`;
        });
        alert(logs);
    });
}
