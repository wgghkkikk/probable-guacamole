<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CH-ALLOSH EMPIRE V15 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --main: #ff6a00; --bot-color: #00d4ff; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        
        body { background: #000; color: white; overflow: hidden; position: fixed; width: 100%; height: 100%; }
        .stars { position: fixed; inset: 0; background: url('https://www.transparenttextures.com/patterns/stardust.png'); z-index: -1; animation: moveStars 60s linear infinite; }
        @keyframes moveStars { from { background-position: 0 0; } to { background-position: 1000px 1000px; } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .top-bar { height: 60px; background: rgba(15,15,15,0.9); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 2px solid var(--main); z-index: 1000; position: relative; }
        
        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side { position: fixed; top: 60px; bottom: 85px; width: 260px; background: rgba(10,10,10,0.95); transition: 0.3s; z-index: 1500; border: 1px solid #333; overflow-y: auto; }
        #side-r { right: -260px; border-left: 2px solid var(--main); }
        #side-l { left: -260px; border-right: 2px solid var(--main); }
        .side.open { right: 0 !important; left: 0 !important; }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´ */
        .king-section { text-align: center; padding: 20px 10px; }
        .crown-anim { font-size: 50px; display: block; animation: bounce 2s infinite; filter: drop-shadow(0 0 15px gold); }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .king-text { font-size: 24px; font-weight: 900; background: linear-gradient(to right, #fff, gold, #ff6a00); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* Ø§Ù„Ø´Ø§Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .chat-view { position: absolute; top: 60px; bottom: 85px; width: 100%; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; }
        .msg-box { display: flex; gap: 10px; align-items: flex-start; animation: fadeIn 0.3s; }
        .u-avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--main); object-fit: cover; }
        .msg-text { background: rgba(30,30,30,0.8); padding: 10px; border-radius: 15px; border-right: 4px solid var(--main); max-width: 75%; position: relative; }
        .bot-msg { border-right: 4px solid var(--bot-color) !important; background: rgba(0, 212, 255, 0.1) !important; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        #emoji-grid { position: absolute; bottom: 85px; width: 100%; height: 220px; background: #111; display: none; grid-template-columns: repeat(5, 1fr); gap: 10px; padding: 15px; overflow-y: auto; border-top: 2px solid var(--main); z-index: 2000; }
        .emoji-gif { width: 100%; cursor: pointer; border-radius: 5px; }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-bar { position: fixed; bottom: 0; width: 100%; height: 85px; background: #000; display: flex; align-items: center; padding: 0 10px; gap: 10px; border-top: 1px solid #222; }
        #input-msg { flex: 1; height: 45px; background: #1a1a1a; border: 1px solid #333; border-radius: 25px; color: white; padding: 0 15px; outline: none; }
        .tool-btn { background: none; border: none; font-size: 26px; cursor: pointer; color: white; }
    </style>
</head>
<body>

<div class="stars"></div>

<div class="top-bar">
    <button onclick="toggleSide('side-l')" class="tool-btn">âš™ï¸</button>
    <div style="color:var(--main); font-weight:900;">ALLOSH EMPIRE</div>
    <button onclick="toggleSide('side-r')" class="tool-btn">ğŸ‘¥</button>
</div>

<div id="side-r" class="side">
    <div id="users-container"></div>
    <div style="padding:15px; text-align:center; color:var(--bot-color); border-top:1px solid #222;">
        <b>ğŸ¤– Ø¹Ù„ÙˆØ´ Ø¨ÙˆØª</b><br><small>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…ÙØ¹Ù„</small>
    </div>
</div>

<div id="side-l" class="side">
    <div style="padding:20px; text-align:center;">
        <h3>ğŸ›¡ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
        <hr style="margin:15px 0; opacity:0.2;">
        <button onclick="clearChat()" style="width:100%; padding:12px; background:red; border:none; border-radius:10px; color:white; margin-bottom:10px;">Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Øª ğŸ§¹</button>
        <button onclick="lockChat()" style="width:100%; padding:12px; background:orange; border:none; border-radius:10px; color:white;">Ù‚ÙÙ„ Ø§Ù„Ø´Ø§Øª ğŸ”’</button>
        <hr style="margin:15px 0; opacity:0.2;">
        <button onclick="changeName()" style="width:100%; padding:10px; background:#333; border:none; border-radius:10px; color:white;">ØªØºÙŠÙŠØ± Ø§Ø³Ù…ÙŠ âœ¨</button>
    </div>
</div>

<div id="emoji-grid">
    <img class="emoji-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnZ4Z2R0NXJscHB4Y25xZ3R5ZnN3bTZqZzR4ZzR4ZzR4ZzR4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/v6aOebdclIYBkPjn9D/giphy.gif" onclick="sendEmoji(this.src)">
    <img class="emoji-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHp4Z2R0NXJscHB4Y25xZ3R5ZnN3bTZqZzR4ZzR4ZzR4ZzR4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/L2S1Y7Z9Xf3mD5uB5y/giphy.gif" onclick="sendEmoji(this.src)">
    <img class="emoji-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnZ4Z2R0NXJscHB4Y25xZ3R5ZnN3bTZqZzR4ZzR4ZzR4ZzR4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/8vIFoK3N6R4FwK2vC7/giphy.gif" onclick="sendEmoji(this.src)">
</div>

<div class="chat-view" id="chat-box"></div>

<div class="bottom-bar">
    <button class="tool-btn" style="color:var(--main);" onclick="uploadImg()">â•</button>
    <button class="tool-btn" onclick="toggleEmoji()">ğŸ˜Š</button>
    <input type="text" id="input-msg" placeholder="Ø§ÙƒØªØ¨ ÙŠØ§ Ù…Ù„Ùƒ..." onkeypress="if(event.key==='Enter') sendMsg()">
    <button class="tool-btn" onclick="sendMsg()">ğŸš€</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let me = JSON.parse(localStorage.getItem('allosh_v15')) || {
        id: "u_" + Math.random().toString(16).slice(2,8),
        name: "Ø¹Ù„ÙˆØ´",
        avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
        rank: "ØµØ§Ø­Ø¨ Ø§Ù„Ø´Ø§Øª ğŸ‘‘"
    };

    function toggleSide(id) { 
        document.getElementById('side-r').classList.remove('open');
        document.getElementById('side-l').classList.remove('open');
        document.getElementById(id).classList.add('open');
    }
    document.body.onclick = (e) => { if(e.clientX > 260 && e.clientX < (window.innerWidth - 260)) { document.getElementById('side-r').classList.remove('open'); document.getElementById('side-l').classList.remove('open'); } };

    function toggleEmoji() { let g = document.getElementById('emoji-grid'); g.style.display = (g.style.display==='grid'?'none':'grid'); }

    function sendMsg() {
        let i = document.getElementById('input-msg'); if(!i.value) return;
        db.ref('msgs_v15').push({ sender: me.name, text: i.value, avatar: me.avatar, type: 'text' });
        i.value = "";
    }

    function sendEmoji(url) {
        db.ref('msgs_v15').push({ sender: me.name, text: url, avatar: me.avatar, type: 'gif' });
        toggleEmoji();
    }

    function start() {
        db.ref('users_v15/'+me.id).set(me);
        db.ref('users_v15/'+me.id).onDisconnect().remove();

        // Ø§Ù„Ø¨ÙˆØª ÙŠØ±Ø­Ø¨ Ø¨Ùƒ
        setTimeout(() => {
            pushBotMsg(`Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø¹Ù„ÙˆØ´ØŒ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© V15 Ø¬Ø§Ù‡Ø² Ù„Ø®Ø¯Ù…ØªÙƒ! ğŸ›¡ï¸ğŸ‘‘`);
        }, 2000);

        db.ref('users_v15').on('value', s => {
            let h = "";
            s.forEach(u => {
                let d = u.val();
                if(d.rank.includes("ØµØ§Ø­Ø¨")) {
                    h += `<div class="king-section"><span class="crown-anim">ğŸ‘‘</span><span class="king-text">${d.name}</span></div>`;
                } else {
                    h += `<div style="padding:12px; border-bottom:1px solid #222;">â— ${d.name}</div>`;
                }
            });
            document.getElementById('users-container').innerHTML = h;
        });

        db.ref('msgs_v15').limitToLast(30).on('child_added', s => {
            let d = s.val();
            let box = document.getElementById('chat-box');
            let div = document.createElement('div');
            div.className = "msg-box";
            let content = d.type === 'gif' ? `<img src="${d.text}" style="width:120px; border-radius:10px;">` : d.text;
            div.innerHTML = `<img src="${d.avatar}" class="u-avatar">
                             <div class="msg-text ${d.bot?'bot-msg':''}">
                                <b style="color:${d.bot? 'var(--bot-color)':'var(--main)'}; font-size:12px;">${d.sender}</b><br>${content}
                             </div>`;
            box.appendChild(div);
            box.scrollTop = box.scrollHeight;
        });
    }

    function pushBotMsg(txt) {
        let box = document.getElementById('chat-box');
        let div = document.createElement('div');
        div.className = "msg-box";
        div.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/4712/4712035.png" class="u-avatar" style="border-color:var(--bot-color)">
                         <div class="msg-text bot-msg"><b style="color:var(--bot-color)">Ø¹Ù„ÙˆØ´ Ø¨ÙˆØª ğŸ¤–</b><br>${txt}</div>`;
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    }

    function clearChat() { if(confirm("Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ØŸ")) db.ref('msgs_v15').remove(); }
    function changeName() { let n = prompt("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯:"); if(n) { me.name = n; localStorage.setItem('allosh_v15', JSON.stringify(me)); location.reload(); } }

    start();
</script>
</body>
</html>
