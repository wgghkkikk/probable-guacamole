<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CH-ALLOSH EMPIRE V12 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@600;900&display=swap');
        :root { --dark: #121821; --blue: #3498db; --gold: #f1c40f; --gradient: linear-gradient(45deg, #ff416c, #ff4b2b); }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        body { background: #000; color: white; overflow: hidden; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© 2) */
        .header { height: 60px; background: #1a1a1a; display: flex; align-items: center; justify-content: space-around; border-bottom: 1px solid #333; }
        .head-icon { color: #3498db; font-size: 22px; cursor: pointer; }
        .user-mini { width: 35px; height: 35px; border-radius: 50%; border: 1px solid #4caf50; position: relative; }
        .online-dot { position: absolute; bottom: 0; right: 0; width: 10px; height: 10px; background: #4caf50; border-radius: 50%; border: 1px solid white; }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© (Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© 1) */
        .user-card { background: #2c3e50; width: 280px; border-radius: 15px; overflow: hidden; text-align: center; display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 5000; }
        .lvl-tag { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.5); padding: 2px 8px; border-radius: 10px; color: gold; font-size: 12px; }
        .card-avatar { width: 80px; height: 80px; border-radius: 50%; border: 3px solid white; margin-top: 20px; }
        .card-btn { padding: 12px; border-bottom: 1px solid #34495e; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .card-btn:hover { background: rgba(255,255,255,0.1); }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª (Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© 6) */
        .frame-modal { background: #1a1e26; width: 90%; max-width: 350px; border-radius: 15px; padding: 15px; display: none; flex-direction: column; align-items: center; }
        .frame-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .frame-item { width: 60px; height: 60px; border-radius: 50%; border: 2px solid transparent; cursor: pointer; }
        .frame-item.active { border-color: gold; }

        /* Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª (Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© 4) */
        .posts-section { background: #121821; border-radius: 15px; padding: 15px; margin-top: 20px; border: 1px solid #1e272e; }
        .upload-area { border: 1px dashed #3498db; padding: 20px; border-radius: 10px; text-align: center; cursor: pointer; }
        .post-btn { background: var(--gradient); border: none; padding: 10px 30px; border-radius: 5px; color: white; margin-top: 10px; }

        /* Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ§Øª Ù…ØªØ­Ø±ÙƒØ© (Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© 3) */
        #emoji-panel { display: none; background: #2c3e50; border-top: 2px solid #3498db; position: absolute; bottom: 85px; width: 100%; height: 250px; overflow-y: auto; padding: 10px; display: none; grid-template-columns: repeat(6, 1fr); gap: 10px; }
        .emoji-gif { width: 100%; cursor: pointer; }
    </style>
</head>
<body>

<div class="header">
    <i class="head-icon">ğŸ“§</i>
    <i class="head-icon">ğŸ®</i>
    <i class="head-icon" onclick="location.reload()">ğŸ”„</i>
    <i class="head-icon">ğŸ‘¤+</i>
    <i class="head-icon">ğŸ””</i>
    <i class="head-icon">ğŸ´</i>
    <div class="user-mini" onclick="openMyMenu()">
        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" id="my-mini-img" style="width:100%; border-radius:50%">
        <div class="online-dot"></div>
    </div>
</div>

<div id="user-card" class="user-card">
    <div class="lvl-tag">â­ 41</div>
    <img src="" id="card-img" class="card-avatar">
    <h3 id="card-name">ÙƒØ±Ø§Ø± Ù†ÙˆØ±</h3>
    <p style="font-size:12px; color:#bdc3c7;">Ø³Ù†ÙˆØ§Øª â€¢ Ø°ÙƒØ± 33</p>
    <img src="https://flagcdn.com/w40/iq.png" width="25">
    <div class="card-btn" style="background:#222; color:white;">ğŸ‘¤ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</div>
    <div class="card-btn">ğŸ§¡ Ø®Ø§Øµ</div>
    <div class="card-btn">ğŸ“ Ù…ÙƒØ§Ù„Ù…Ø©</div>
    <div id="admin-tools" class="card-btn" style="color:#e74c3c;">âœ”ï¸ Ø§Ù„Ø£ÙˆØ§Ù…Ø±</div>
    <button onclick="closeCard()" style="width:100%; background:none; border:none; color:gray; padding:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="frame-modal" class="user-card" style="display:none; padding:15px;">
    <p style="color:red; font-size:12px;">* change will cost you 20 Ø±ÙˆØ¨ÙŠ</p>
    <div class="frame-grid">
        <img class="frame-item" src="https://i.ibb.co/L9Y0YpL/frame1.png" onclick="setFrame(1)">
        <img class="frame-item" src="https://i.ibb.co/hZ2v6mK/frame2.png" onclick="setFrame(2)">
        </div>
    <button class="post-btn" style="width:100%">Ø­ÙØ¸ ğŸ”’</button>
</div>

<div id="chat-box" style="height: calc(100vh - 145px); overflow-y: auto; padding: 15px;"></div>

<div id="emoji-panel">
    <img class="emoji-gif" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHp4Z2R0NXJscHB4Y25xZ3R5ZnN3bTZqZzR4ZzR4ZzR4ZzR4ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/v6aOebdclIYBkPjn9D/giphy.gif" onclick="sendGif(this.src)">
    </div>

<div style="position:fixed; bottom:0; width:100%; height:85px; background:#1a1a1a; display:flex; align-items:center; padding:10px; gap:10px;">
    <button style="background:none; border:none; color:#3498db; font-size:24px;" onclick="uploadFile()">â•</button>
    <button style="background:none; border:none; font-size:24px;" onclick="toggleEmoji()">ğŸ˜Š</button>
    <input type="text" id="msg-in" style="flex:1; background:#222; border:1px solid #444; border-radius:20px; color:white; padding:10px;" placeholder="Ø§ÙƒØªØ¨ Ø´ÙŠØ¦Ø§Ù‹...">
    <button onclick="sendMsg()" style="background:none; border:none; font-size:24px;">ğŸš€</button>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Firebase ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let me = { id: "u123", name: "Ø¹Ù„ÙˆØ´", rank: "ØµØ§Ø­Ø¨ Ø§Ù„Ø´Ø§Øª", avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png" };

    function openMyMenu() {
        document.getElementById('user-card').style.display = 'block';
        document.getElementById('card-img').src = me.avatar;
        document.getElementById('card-name').innerText = me.name;
    }

    function closeCard() { document.getElementById('user-card').style.display = 'none'; }
    function toggleEmoji() { let p = document.getElementById('emoji-panel'); p.style.display = (p.style.display==='grid'?'none':'grid'); }

    function sendMsg() {
        let text = document.getElementById('msg-in').value;
        if(!text) return;
        db.ref('msgs_v12').push({ sender: me.name, text: text, avatar: me.avatar, uid: me.id });
        document.getElementById('msg-in').value = "";
    }

    // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¹Ø±Ø¶Ù‡Ø§ Ø¨ØªÙ†Ø³ÙŠÙ‚ Ø§Ø­ØªØ±Ø§ÙÙŠ
    db.ref('msgs_v12').limitToLast(20).on('child_added', s => {
        let d = s.val();
        let div = document.createElement('div');
        div.style = "margin-bottom:15px; display:flex; gap:10px; align-items:start;";
        div.innerHTML = `<img src="${d.avatar}" style="width:40px; height:40px; border-radius:50%;" onclick="showUser('${d.uid}')">
                         <div style="background:#1e272e; padding:10px; border-radius:12px; max-width:70%;">
                            <b style="color:gold; font-size:12px;">${d.sender}</b><br>${d.text}
                         </div>`;
        document.getElementById('chat-box').appendChild(div);
        document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
    });

    function showUser(uid) {
        // ÙƒÙˆØ¯ Ø¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø¶Ùˆ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ØµÙˆØ±ØªÙ‡
        openMyMenu(); 
    }
</script>
</body>
</html>
