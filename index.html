<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CH-ALLOSH | Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø¹Ù„ÙˆØ´ ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root {
            --gold: #ffd700;
            --dark-bg: #0a0a0b;
            --msg-bg: #161618;
            --text-color: #e0e0e0;
        }

        body { 
            margin: 0; 
            background-color: var(--dark-bg); 
            color: var(--text-color); 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #master-panel { 
            display: none; 
            background: rgba(255, 215, 0, 0.1); 
            border-bottom: 1px solid var(--gold); 
            padding: 10px; 
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .btn { 
            border: 1px solid var(--gold); 
            padding: 6px 15px; 
            border-radius: 20px; 
            font-weight: bold; 
            cursor: pointer; 
            margin: 5px; 
            background: transparent;
            color: var(--gold);
            transition: 0.3s;
        }

        .btn:hover { background: var(--gold); color: black; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        #chat-area { 
            flex: 1; 
            overflow-y: auto; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            gap: 15px;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #0a0a0b 100%);
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø§Ø³ØªØ± */
        .msg-master { 
            align-self: flex-start;
            max-width: 80%;
            background: linear-gradient(135deg, #1e1e1e, #111);
            border-right: 4px solid var(--gold);
            padding: 12px 18px;
            border-radius: 15px 15px 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            position: relative;
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ø¶Ùˆ */
        .msg-member { 
            align-self: flex-start;
            max-width: 80%;
            background: var(--msg-bg);
            padding: 12px 18px;
            border-radius: 15px 15px 15px 0;
            border-right: 4px solid #444;
        }

        .badge { 
            font-size: 9px; 
            padding: 2px 7px; 
            border-radius: 50px; 
            font-weight: bold; 
            display: inline-block;
            margin-bottom: 5px;
        }

        .badge-master { background: var(--gold); color: #000; text-shadow: none; }
        .badge-member { background: #333; color: #bbb; }

        .sender-name { font-weight: bold; font-size: 14px; display: block; margin-bottom: 4px; }
        .master-name { color: var(--gold); }
        .member-name { color: #5bc0de; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© */
        .footer { 
            padding: 20px; 
            background: #111; 
            display: flex; 
            gap: 12px;
            border-top: 1px solid #222;
        }

        input { 
            flex: 1; 
            background: #1e1e1e; 
            border: 1px solid #333; 
            color: white; 
            padding: 12px 20px; 
            border-radius: 25px; 
            outline: none;
            font-size: 15px;
        }

        input:focus { border-color: var(--gold); }

        #sendBtn { 
            background: var(--gold); 
            color: #000; 
            border: none; 
            width: 50px; 
            height: 50px; 
            border-radius: 50%; 
            font-weight: bold; 
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ø·Ø±ÙˆØ¯ */
        .kicked-screen {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; background: black; color: red;
        }
    </style>
</head>
<body>

<div id="master-panel">
    <button class="btn" onclick="clearChat()">ğŸ§¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©</button>
    <button id="lockBtn" class="btn" onclick="toggleLock()">ğŸ”’ Ù‚ÙÙ„ Ø§Ù„Ø´Ø§Øª</button>
</div>

<div id="chat-area"></div>

<div class="footer">
    <input type="text" id="mInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ ÙŠØ§ Ù…Ù„Ùƒ..." onkeypress="if(event.key==='Enter') send()">
    <button id="sendBtn" onclick="send()">â</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let myName = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙŠØ§ Ù…Ù„Ùƒ:"); 
    if (!myName) { location.reload(); }

    let myRank = "Ø¹Ø¶Ùˆ";
    let isChatLocked = false;

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø§Ø³ØªØ±
    if (myName.trim() === "Ø¹Ù„ÙˆØ´") {
        let pass = prompt("ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ù…Ø§Ø³ØªØ±:");
        if (pass === "Allosh#King@2025") { 
            myRank = "Ø§Ù„Ù…Ø§Ø³ØªØ±";
            document.getElementById('master-panel').style.display = 'block';
        } else {
            alert("Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø·!");
            myName = "Ø²Ø§Ø¦Ø±_" + Math.floor(Math.random()*100);
        }
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ø±Ø¯ ÙˆØ§Ù„Ù‚ÙÙ„
    db.ref('kicked/' + myName).on('value', snap => {
        if(snap.exists()) {
            document.body.innerHTML = "<div class='kicked-screen'><h1>ğŸš« ØªÙ… Ø·Ø±Ø¯Ùƒ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</h1><p>Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø§Ø³ØªØ± Ø¹Ù„ÙˆØ´</p></div>";
        }
    });

    db.ref('chat_status').on('value', snap => {
        isChatLocked = snap.val()?.locked || false;
        document.getElementById('mInput').disabled = (isChatLocked && myRank !== "Ø§Ù„Ù…Ø§Ø³ØªØ±");
        document.getElementById('lockBtn').innerText = isChatLocked ? "ğŸ”“ ÙØªØ­ Ø§Ù„Ø´Ø§Øª" : "ğŸ”’ Ù‚ÙÙ„ Ø§Ù„Ø´Ø§Øª";
    });

    function send() {
        let input = document.getElementById('mInput');
        let text = input.value.trim();
        if(!text || (isChatLocked && myRank !== "Ø§Ù„Ù…Ø§Ø³ØªØ±")) return;
        db.ref('messages').push({ sender: myName, content: text, role: myRank });
        input.value = "";
    }

    function clearChat() { if(confirm("Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ØŸ")) db.ref('messages').remove(); }
    function toggleLock() { db.ref('chat_status').set({ locked: !isChatLocked }); }
    
    function kickUser(name) {
        if(myRank === "Ø§Ù„Ù…Ø§Ø³ØªØ±" && name !== myName) {
            if(confirm("Ø·Ø±Ø¯ " + name + "ØŸ")) db.ref('kicked/' + name).set(true);
        }
    }

    db.ref('messages').limitToLast(50).on('child_added', snap => {
        let data = snap.val();
        let isM = data.role === "Ø§Ù„Ù…Ø§Ø³ØªØ±";
        let div = document.createElement('div');
        div.className = isM ? "msg-master" : "msg-member";
        div.onclick = () => kickUser(data.sender);
        div.innerHTML = `
            <span class="badge ${isM?'badge-master':'badge-member'}">${isM?'Ø§Ù„Ù…Ø§Ø³ØªØ±':'Ø¹Ø¶Ùˆ'}</span>
            <span class="sender-name ${isM?'master-name':'member-name'}">${data.sender}</span>
            <div class="content">${data.content}</div>
        `;
        document.getElementById('chat-area').appendChild(div);
        document.getElementById('chat-area').scrollTop = document.getElementById('chat-area').scrollHeight;
    });

    db.ref('messages').on('value', snap => { if(!snap.exists()) document.getElementById('chat-area').innerHTML = ""; });
</script>
</body>
</html>
