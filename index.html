<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إمبراطورية الماستر RG</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root { --main-color: #00f2ff; --bg-dark: #0a0a0a; --accent: #ff004c; }
        body { background: #000; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* الهيدر */
        header { background: #111; padding: 15px; text-align: center; border-bottom: 2px solid var(--main-color); box-shadow: 0 0 15px var(--main-color); }
        header h1 { margin: 0; font-size: 20px; letter-spacing: 2px; color: var(--main-color); text-shadow: 0 0 5px var(--main-color); }

        /* منطقة الرسائل */
        #chat-box { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; background: radial-gradient(circle, #111 0%, #000 100%); }
        .msg { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 15px; border-right: 4px solid var(--main-color); max-width: 80%; align-self: flex-start; animation: fadeIn 0.3s ease; }
        .msg b { color: var(--accent); display: block; font-size: 12px; margin-bottom: 5px; }

        /* منطقة الإدخال */
        .input-area { background: #111; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #222; }
        input { flex: 1; background: #000; border: 1px solid var(--main-color); color: #fff; padding: 12px 20px; border-radius: 30px; outline: none; }
        button { background: var(--main-color); color: #000; border: none; padding: 10px 25px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #fff; box-shadow: 0 0 10px #fff; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <h1>MASTER CHAT SYSTEM</h1>
</header>

<div id="chat-box">
    <div class="msg"><b>النظام:</b> أهلاً بك يا ماستر.. الشات الآن متصل بقاعدة بيانات Firebase.</div>
</div>

<div class="input-area">
    <input type="text" id="userMsg" placeholder="اكتب رسالتك السرية هنا...">
    <button onclick="sendMessage()">إرسال</button>
</div>

<script>
    // إعدادات Firebase الخاصة بك (الكود الصغير مدموج هنا)
    const firebaseConfig = {
        apiKey: "AIzaSyByMjoJ0Z8itTkh44-98crRVh_pxFh3pfo",
        authDomain: "masterchat-57885.firebaseapp.com",
        projectId: "masterchat-57885",
        storageBucket: "masterchat-57885.firebasestorage.app",
        messagingSenderId: "729235648436",
        appId: "1:729235648436:web:f706da6984175f45a70ce1",
        measurementId: "G-WSGK6RH6JY",
        databaseURL: "https://masterchat-57885-default-rtdb.firebaseio.com"
    };

    // تهيئة Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // وظيفة إرسال الرسالة
    function sendMessage() {
        const msgInput = document.getElementById('userMsg');
        const message = msgInput.value;

        if (message.trim() !== "") {
            database.ref('messages').push({
                username: "زائر",
                text: message,
                timestamp: Date.now()
            });
            msgInput.value = ""; // تفريغ الحقل بعد الإرسال
        }
    }

    // الاستماع للرسائل الجديدة وعرضها فوراً
    database.ref('messages').on('child_added', (snapshot) => {
        const data = snapshot.val();
        const chatBox = document.getElementById('chat-box');
        
        const msgDiv = document.createElement('div');
        msgDiv.className = 'msg';
        msgDiv.innerHTML = `<b>${data.username}:</b> ${data.text}`;
        
        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight; // النزول لآخر رسالة تلقائياً
    });

    // الإرسال عند الضغط على زر Enter
    document.getElementById('userMsg').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });
</script>

</body>
</html>
