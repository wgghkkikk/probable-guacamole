<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SULTAN CHAT V21 ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap');
        :root { --gold: #d4af37; --dark-glass: rgba(0, 0, 0, 0.85); --accent: #ff6a00; }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; }
        
        body { background: #000; color: white; overflow: hidden; height: 100vh; }
        .bg-overlay { position: fixed; inset: 0; background: url('https://i.ibb.co/L8N7pPr/stars-bg.jpg') center; background-size: cover; z-index: -2; opacity: 0.5; }
        .stars { position: fixed; inset: 0; background: url('https://www.transparenttextures.com/patterns/stardust.png'); z-index: -1; animation: moveStars 100s linear infinite; }
        @keyframes moveStars { from { background-position: 0 0; } to { background-position: 1000px 1000px; } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .header { height: 65px; background: var(--dark-glass); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 2px solid var(--gold); box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); z-index: 2000; position: relative; }
        .h-btn { font-size: 26px; cursor: pointer; color: var(--gold); background: none; border: none; transition: 0.3s; }
        .h-btn:hover { transform: scale(1.2); text-shadow: 0 0 10px var(--gold); }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ (Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†) */
        .side-right { position: fixed; top: 65px; right: -280px; width: 280px; bottom: 85px; background: var(--dark-glass); border-left: 2px solid var(--gold); transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1500; overflow-y: auto; backdrop-filter: blur(10px); }
        .side-right.open { right: 0; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠØ³Ø±Ù‰ (Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ) */
        .side-left { position: fixed; top: 65px; left: -300px; width: 300px; bottom: 85px; background: var(--dark-glass); border-right: 2px solid var(--gold); transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); z-index: 1500; overflow-y: auto; backdrop-filter: blur(10px); }
        .side-left.open { left: 0; }

        /* ØªØµÙ…ÙŠÙ… ÙƒØ±ÙˆØª Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† */
        .user-item { display: flex; align-items: center; gap: 10px; padding: 12px; border-bottom: 1px solid rgba(212, 175, 55, 0.1); transition: 0.3s; }
        .user-item:hover { background: rgba(212, 175, 55, 0.05); }
        .u-status { width: 10px; height: 10px; background: #2ecc71; border-radius: 50%; box-shadow: 0 0 5px #2ecc71; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-chat { position: absolute; top: 65px; bottom: 85px; width: 100%; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .msg-container { display: flex; gap: 12px; align-items: flex-end; animation: slideUp 0.3s ease; }
        .msg-avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--gold); padding: 2px; }
        .msg-bubble { background: rgba(255,255,255,0.05); border: 1px solid rgba(212, 175, 55, 0.2); padding: 12px; border-radius: 15px 15px 0 15px; max-width: 75%; position: relative; backdrop-filter: blur(5px); }
        .owner-msg { border-right: 4px solid var(--gold); background: rgba(212, 175, 55, 0.05); }

        /* Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„ÙØ®Ù… (ÙŠØ³Ø§Ø±) */
        .profile-header { height: 120px; background: linear-gradient(to bottom, var(--gold), transparent); position: relative; }
        .profile-img { width: 100px; height: 100px; border-radius: 50%; border: 4px solid #000; position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%); box-shadow: 0 0 20px var(--gold); }
        .profile-info { margin-top: 60px; text-align: center; padding: 20px; }

        /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        .footer { position: fixed; bottom: 0; width: 100%; height: 85px; background: #000; border-top: 2px solid var(--gold); display: flex; align-items: center; padding: 0 15px; gap: 10px; z-index: 2000; }
        #input-box { flex: 1; height: 45px; background: rgba(255,255,255,0.05); border: 1px solid #333; border-radius: 25px; color: white; padding: 0 20px; outline: none; transition: 0.3s; }
        #input-box:focus { border-color: var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="bg-overlay"></div>
<div class="stars"></div>

<div class="header">
    <button class="h-btn" onclick="toggleSide('side-l')">âš™ï¸</button>
    <div style="text-align: center;">
        <div style="color:var(--gold); font-weight:900; font-size:20px; text-shadow: 0 0 10px gold;">ALLOSH ROYAL V21</div>
        <div id="online-count" style="font-size:10px; color:#aaa;">Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†: Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
    <button class="h-btn" onclick="toggleSide('side-r')">ğŸ‘¥</button>
</div>

<div id="side-r" class="side-right">
    <div style="padding:20px; color:var(--gold); font-weight:900; border-bottom:1px solid #333;">Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø§Ù„Ø¢Ù†</div>
    <div id="users-list"></div>
</div>

<div id="side-l" class="side-left">
    <div class="profile-header">
        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" class="profile-img">
    </div>
    <div class="profile-info">
        <h2 id="p-name">Ø¹Ù„ÙˆØ´</h2>
        <p style="color:var(--gold);">Ø§Ù„Ø±ØªØ¨Ø©: Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø§Ù„Ø´Ø§Øª ğŸ‘‘</p>
        <div style="display:flex; justify-content:space-around; margin-top:30px;">
            <div><b style="color:var(--gold)">1.5k</b><br><small>Ù†Ù‚Ø§Ø·</small></div>
            <div><b style="color:var(--gold)">100</b><br><small>Ù„ÙÙ„</small></div>
        </div>
        <hr style="margin:30px 0; opacity:0.1;">
        <button onclick="clearChat()" style="width:100%; padding:12px; background:rgba(255,0,0,0.1); border:1px solid red; color:red; border-radius:10px;">Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª ğŸ§¹</button>
    </div>
</div>

<div class="main-chat" id="chat-box"></div>

<div class="footer">
    <button class="h-btn" onclick="alert('Ù…ØªØ¬Ø± Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ù‚Ø§Ø¯Ù…!')">ğŸ</button>
    <input type="text" id="input-box" placeholder="ØªØ­Ø¯Ø« ÙŠØ§ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±..." onkeypress="if(event.key==='Enter') send()">
    <button class="h-btn" style="color:var(--accent)" onclick="send()">ğŸš€</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let me = {
        id: "allosh_king",
        name: "Ø¹Ù„ÙˆØ´",
        avatar: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
        rank: "Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±"
    };

    function toggleSide(id) {
        let sideR = document.getElementById('side-r');
        let sideL = document.getElementById('side-l');
        if(id === 'side-r') { sideR.classList.toggle('open'); sideL.classList.remove('open'); }
        else { sideL.classList.toggle('open'); sideR.classList.remove('open'); }
    }

    function send() {
        let i = document.getElementById('input-box'); if(!i.value) return;
        db.ref('msgs_v21').push({ sender: me.name, text: i.value, avatar: me.avatar, isOwner: true });
        i.value = "";
    }

    // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
    db.ref('msgs_v21').limitToLast(40).on('child_added', s => {
        let d = s.val();
        let box = document.getElementById('chat-box');
        let div = document.createElement('div');
        div.className = "msg-container";
        div.innerHTML = `
            <img src="${d.avatar}" class="msg-avatar">
            <div class="msg-bubble ${d.isOwner?'owner-msg':''}">
                <b style="color:var(--gold); font-size:12px;">${d.sender}</b><br>${d.text}
            </div>
        `;
        box.appendChild(div);
        box.scrollTop = box.scrollHeight;
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† (ØªØ¬Ø±ÙŠØ¨ÙŠ)
    db.ref('users_v21').on('value', s => {
        let list = document.getElementById('users-list');
        let h = ""; let count = 0;
        s.forEach(u => {
            count++;
            let d = u.val();
            h += `<div class="user-item">
                    <div class="u-status"></div>
                    <img src="${d.avatar}" style="width:35px; height:35px; border-radius:50%;">
                    <b>${d.name}</b>
                  </div>`;
        });
        list.innerHTML = h;
        document.getElementById('online-count').innerText = `Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†: ${count}`;
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø§Ù„Ùƒ
    db.ref('users_v21/'+me.id).set(me);
    db.ref('users_v21/'+me.id).onDisconnect().remove();

    function clearChat() { if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø´Ø§ØªØŸ")) db.ref('msgs_v21').remove(); }
</script>
</body>
</html>
