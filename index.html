<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø§Ø³ØªØ± RG</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --neon: #00f2ff; --pink: #ff004c; --gold: #ffcc00; --bg: #050505; }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        .main-app { display: flex; flex: 1; overflow: hidden; }
        .panel { width: 230px; background: #111; padding: 15px; border: 1px solid #222; display: flex; flex-direction: column; gap: 15px; }
        #chat-view { flex: 1; display: flex; flex-direction: column; background: #000; position: relative; }
        #msg-container { flex: 1; padding: 20px; overflow-y: auto; }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© */
        .msg-row { display: flex; gap: 12px; margin-bottom: 20px; align-items: flex-start; }
        .msg-avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--neon); cursor: pointer; transition: 0.3s; }
        .msg-avatar:hover { transform: scale(1.1); box-shadow: 0 0 10px var(--neon); }
        .msg-bubble { background: #181818; padding: 12px; border-radius: 15px; flex: 1; border: 1px solid #222; position: relative; }
        .msg-info { font-weight: bold; font-size: 13px; color: var(--neon); margin-bottom: 5px; display: flex; justify-content: space-between; }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù ÙˆØ§Ù„Ø§Ù‚ØªØ¨Ø§Ø³ */
        .msg-btns { margin-top: 8px; display: flex; gap: 8px; }
        .btn-s { background: #222; border: 1px solid #333; color: #888; font-size: 10px; padding: 3px 8px; border-radius: 5px; cursor: pointer; }
        .btn-s:hover { background: #333; color: #fff; }
        .del-x { color: var(--pink) !important; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        #profile-card { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 320px; background: #111; border: 2px solid var(--neon); border-radius: 20px; z-index: 2000; overflow: hidden; box-shadow: 0 0 100px rgba(0,0,0,0.9); }
        .card-cover { width: 100%; height: 100px; background: linear-gradient(45deg, #1a1a1a, #333); object-fit: cover; }
        .card-p-img { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--neon); margin: -40px auto 10px; display: block; background: #222; }
        .card-content { text-align: center; padding: 15px; }
        .like-zone { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 15px; font-size: 20px; }
        .heart { color: var(--pink); cursor: pointer; transition: 0.3s; }
        .heart:hover { transform: scale(1.3); }

        /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
        .input-bar { padding: 15px; background: #111; display: flex; gap: 10px; border-top: 1px solid #222; }
        #mInput { flex: 1; background: #000; border: 1px solid #333; color: #fff; padding: 12px 20px; border-radius: 30px; }
        #sendBtn { background: var(--neon); color: #000; border: none; padding: 0 25px; border-radius: 30px; font-weight: bold; cursor: pointer; }

        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1500; }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="closeProfile()"></div>

<div class="main-app">
    <div class="panel" style="border-right: none; border-left: 1px solid #222;">
        <h3 style="color:var(--neon); font-size:14px; text-align:center;">Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙˆÙ†</h3>
        <div id="users-online">
            <div style="color:var(--gold)">ğŸ‘‘ Ø§Ù„Ù…Ø§Ø³ØªØ± RG</div>
            <div style="color:#777">ğŸ‘¤ Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</div>
        </div>
    </div>

    <div id="chat-view">
        <div id="msg-container"></div>
        <div class="input-bar">
            <input type="text" id="mInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ ÙŠØ§ Ø¨Ø·Ù„...">
            <button id="sendBtn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <div class="panel">
        <div style="text-align:center; background:#1a1a1a; padding:10px; border-radius:10px; border:1px solid var(--neon); cursor:pointer;" onclick="openMyProfile()">
            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" id="myIcon" style="width:50px; border-radius:50%;">
            <div id="myNameDisplay" style="font-weight:bold; margin-top:5px;">Ø§Ù„Ù…Ø§Ø³ØªØ± RG</div>
            <div style="font-size:10px; color:var(--gold)">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</div>
        </div>
        <button class="btn-s" style="width:100%" onclick="location.reload()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Øª</button>
    </div>
</div>

<div id="profile-card">
    <img src="https://wallpaperaccess.com/full/265510.jpg" class="card-cover" id="viewCover">
    <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" class="card-p-img" id="viewImg">
    <div class="card-content">
        <h2 id="viewName" style="margin:0; color:var(--neon);">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h2>
        <p style="color:#666; font-size:12px;">Ø¹Ø¶Ùˆ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø§Ø³ØªØ±</p>
        
        <div class="like-zone">
            <span class="heart" onclick="addLike()">â¤ï¸</span>
            <span id="likeCount">0</span> Ø¥Ø¹Ø¬Ø§Ø¨
        </div>

        <div id="edit-tools" style="display:none; margin-top:20px; border-top:1px solid #333; padding-top:10px;">
            <input type="text" id="editName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯" style="width:90%; margin-bottom:5px; background:#000; border:1px solid #444; color:#fff;">
            <input type="text" id="editPic" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±ØªÙƒ" style="width:90%; margin-bottom:5px; background:#000; border:1px solid #444; color:#fff;">
            <button class="btn-s" onclick="saveSettings()">Ø­ÙØ¸</button>
        </div>
    </div>
    <button onclick="closeProfile()" style="width:100%; padding:10px; background:#222; border:none; color:#fff; cursor:pointer;">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ù„ÙŠ
    let myData = {
        name: localStorage.getItem('m-name') || "Ø§Ù„Ù…Ø§Ø³ØªØ±_RG",
        img: localStorage.getItem('m-img') || "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
        likes: parseInt(localStorage.getItem('m-likes')) || 0
    };

    function updateUI() {
        document.getElementById('myIcon').src = myData.img;
        document.getElementById('myNameDisplay').innerText = myData.name;
    }
    updateUI();

    function openMyProfile() {
        document.getElementById('viewName').innerText = myData.name;
        document.getElementById('viewImg').src = myData.img;
        document.getElementById('likeCount').innerText = myData.likes;
        document.getElementById('edit-tools').style.display = 'block';
        document.getElementById('profile-card').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }

    function openAnyProfile(name, img) {
        document.getElementById('viewName').innerText = name;
        document.getElementById('viewImg').src = img;
        document.getElementById('likeCount').innerText = Math.floor(Math.random() * 100); // ØªØ¬Ø±ÙŠØ¨ÙŠ
        document.getElementById('edit-tools').style.display = 'none';
        document.getElementById('profile-card').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }

    function closeProfile() {
        document.getElementById('profile-card').style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
    }

    function saveSettings() {
        myData.name = document.getElementById('editName').value || myData.name;
        myData.img = document.getElementById('editPic').value || myData.img;
        localStorage.setItem('m-name', myData.name);
        localStorage.setItem('m-img', myData.img);
        updateUI();
        closeProfile();
    }

    function addLike() {
        let count = parseInt(document.getElementById('likeCount').innerText);
        document.getElementById('likeCount').innerText = count + 1;
        if(document.getElementById('viewName').innerText === myData.name) {
            myData.likes++;
            localStorage.setItem('m-likes', myData.likes);
        }
    }

    function send() {
        const txt = document.getElementById('mInput').value;
        if(txt) {
            db.ref('messages').push({
                user: myData.name,
                text: txt,
                img: myData.img,
                time: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})
            });
            document.getElementById('mInput').value = '';
        }
    }

    db.ref('messages').on('child_added', (snap) => {
        const m = snap.val();
        const id = snap.key;
        const div = document.createElement('div');
        div.className = 'msg-row';
        div.innerHTML = `
            <img src="${m.img}" class="msg-avatar" onclick="openAnyProfile('${m.user}', '${m.img}')">
            <div class="msg-bubble">
                <div class="msg-info">
                    <span>${m.user}</span>
                    <span style="color:#444; font-size:10px;">${m.time}</span>
                </div>
                <div>${m.text}</div>
                <div class="msg-btns">
                    <button class="btn-s" onclick="quote('${m.user}','${m.text}')">Ø§Ù‚ØªØ¨Ø§Ø³</button>
                    <button class="btn-s del-x" onclick="del('${id}')">Ø­Ø°Ù</button>
                    <button class="btn-s" onclick="alert('ØªÙ… Ø§Ù„ÙƒØªÙ…')">ÙƒØªÙ…</button>
                </div>
            </div>
        `;
        document.getElementById('msg-container').appendChild(div);
        document.getElementById('msg-container').scrollTop = document.getElementById('msg-container').scrollHeight;
    });

    function del(id) { if(confirm('Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŸ')) db.ref('messages/'+id).remove(); location.reload(); }
    function quote(u, t) { document.getElementById('mInput').value = `Ø±Ø¯ Ø¹Ù„Ù‰ ${u}: (${t}) -> `; document.getElementById('mInput').focus(); }
</script>

</body>
</html>
