<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CH-ALLOSH SUPREME ğŸ‘‘</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --gold: #ffd700; --bg: #050505; --panel: #121212; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .top-nav { height: 50px; background: var(--panel); border-bottom: 2px solid var(--gold); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
        .master-btns span { margin: 0 10px; cursor: pointer; font-size: 20px; }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… */
        #wrapper { display: flex; flex: 1; overflow: hidden; position: relative; }
        .sidebar { width: 0; transition: 0.4s; background: var(--panel); overflow-y: auto; white-space: nowrap; position: relative; }
        .sidebar.active { width: 280px; border: 1px solid #222; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        .chat-container { flex: 1; display: flex; flex-direction: column; background: #000; }
        #chat-window { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±ØªØ¨ ÙˆØ§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .name-master { background: linear-gradient(to right, #ffd700, #ff0000, #ffd700); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: anim 2s linear infinite; font-weight: bold; font-size: 1.1em; }
        @keyframes anim { 0%{filter: hue-rotate(0deg);} 100%{filter: hue-rotate(360deg);} }
        
        .badge { font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 5px; color: #000; font-weight: bold; }
        .bg-master { background: var(--gold); }
        .bg-admin { background: #ff00ff; }
        .bg-mod { background: #00ffff; }

        /* Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙˆØ§Ù„ÙŠÙˆÙ…ÙŠØ§Øª */
        .post-card { background: #1a1a1a; padding: 10px; border-radius: 8px; margin: 10px; border-right: 3px solid var(--gold); }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙŠÙˆØªÙŠÙˆØ¨ */
        .chat-img { max-width: 200px; border-radius: 10px; border: 1px solid var(--gold); }
        .yt-frame { width: 100%; max-width: 300px; height: 180px; border-radius: 10px; }

        /* Ø§Ù„ÙÙˆØªØ± */
        .footer { padding: 10px; background: var(--panel); display: flex; gap: 10px; align-items: center; }
        #msg-input { flex: 1; background: #222; border: 1px solid #444; color: white; padding: 10px; border-radius: 20px; outline: none; }
        .add-btn { width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--gold); color: var(--gold); background: none; cursor: pointer; font-size: 20px; }
    </style>
</head>
<body>

<div class="top-nav">
    <div onclick="toggleSide('left')">âš™ï¸ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</div>
    <div class="master-btns" id="m-tools" style="display:none">
        <span onclick="sendAlert('ğŸ“¢ Ø¥Ø¹Ù„Ø§Ù† Ù…Ù„ÙƒÙŠ: Ø§Ù„Ø´Ø§Øª Ù…Ù†ÙˆØ± Ø¨ÙˆØ¬ÙˆØ¯ÙƒÙ…!')">ğŸ“£</span>
        <span onclick="sendAlert('ğŸš¨ ØµØ§ÙØ±Ø© Ø¥Ù†Ø°Ø§Ø±: ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†!')">ğŸ””</span>
    </div>
    <div class="name-master">Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø¹Ù„ÙˆØ´</div>
    <div onclick="toggleSide('right')">ğŸ‘¥ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†</div>
</div>

<div id="wrapper">
    <div id="side-left" class="sidebar">
        <div style="padding: 20px;">
            <center>
                <img id="my-avatar" src="https://cdn-icons-png.flaticon.com/512/1144/1144760.png" style="width:80px; border:2px solid var(--gold); border-radius:50%;">
                <h3 id="my-name-display">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h3>
                <button onclick="changeAvatar()" class="badge">ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©</button>
            </center>
            <hr>
            <h4>ğŸ“– ÙŠÙˆÙ…ÙŠØ§ØªÙŠ</h4>
            <input type="text" id="post-in" placeholder="Ø¨Ù…Ø§Ø°Ø§ ØªÙÙƒØ±ØŸ" style="width:80%; background:#222; color:white; border:1px solid #444; padding:5px;">
            <button onclick="addPost()" class="badge bg-master">Ù†Ø´Ø±</button>
            <div id="diary-area"></div>
        </div>
    </div>

    <div class="chat-container">
        <div id="chat-window"></div>
        <div class="footer">
            <button class="add-btn" onclick="uploadTool()">+</button>
            <input type="text" id="msg-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">
            <button onclick="sendMsg()" style="background:var(--gold); border:none; padding:10px 20px; border-radius:20px; font-weight:bold;">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>

    <div id="side-right" class="sidebar">
        <div style="padding: 20px;">
            <h4>ğŸ‘¥ Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙˆÙ† Ø§Ù„Ø¢Ù†</h4>
            <div id="user-list"></div>
        </div>
    </div>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    let user = { name: "", role: "Ø¹Ø¶Ùˆ", avatar: "" };

    // Ø¯Ø®ÙˆÙ„
    window.onload = () => {
        let n = prompt("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙŠØ§ Ù…Ù„Ùƒ:");
        if(!n) location.reload();
        user.name = n;
        if(n === "Ø¹Ù„ÙˆØ´") {
            let p = prompt("Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø§Ù„Ù…Ø§Ø³ØªØ±:");
            if(p === "Allosh#King@2025") {
                user.role = "Ø§Ù„Ù…Ø§Ø³ØªØ±";
                document.getElementById('m-tools').style.display = "block";
            }
        }
        document.getElementById('my-name-display').innerText = n;
        initChat();
    }

    function toggleSide(id) { document.getElementById('side-'+id).classList.toggle('active'); }

    function initChat() {
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙˆØ§Ø¬Ø¯
        db.ref('online/' + user.name).set(user);
        db.ref('online/' + user.name).onDisconnect().remove();

        // Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†
        db.ref('online').on('value', s => {
            let html = "";
            s.forEach(u => {
                let d = u.val();
                html += `<div style="margin:10px" onclick="adminAction('${d.name}')">
                    <span class="badge ${d.role==='Ø§Ù„Ù…Ø§Ø³ØªØ±'?'bg-master':'bg-member'}">${d.role}</span>
                    <span class="${d.role==='Ø§Ù„Ù…Ø§Ø³ØªØ±'?'name-master':''}">${d.name}</span>
                </div>`;
            });
            document.getElementById('user-list').innerHTML = html;
        });

        // Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        db.ref('messages').limitToLast(30).on('child_added', s => {
            let d = s.val();
            let area = document.getElementById('chat-window');
            let div = document.createElement('div');
            
            let content = d.msg;
            if(content.includes('http') && (content.includes('.jpg') || content.includes('.png') || content.includes('.gif'))) {
                content = `<img src="${content}" class="chat-img">`;
            } else if(content.includes('youtube.com/watch?v=')) {
                let id = content.split('v=')[1];
                content = `<iframe class="yt-frame" src="https://www.youtube.com/embed/${id}" frameborder="0"></iframe>`;
            }

            div.innerHTML = `<b class="${d.role==='Ø§Ù„Ù…Ø§Ø³ØªØ±'?'name-master':''}">${d.sender}:</b> <span>${content}</span>`;
            area.appendChild(div);
            area.scrollTop = area.scrollHeight;
        });
    }

    function sendMsg() {
        let m = document.getElementById('msg-input').value;
        if(!m) return;
        db.ref('messages').push({ sender: user.name, role: user.role, msg: m });
        document.getElementById('msg-input').value = "";
    }

    function uploadTool() {
        let link = prompt("Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§ Ù„Ø±ÙØ¹Ù‡:");
        if(link) { document.getElementById('msg-input').value = link; sendMsg(); }
    }

    function sendAlert(txt) { db.ref('messages').push({ sender: "ğŸ“¢ Ø¥Ø¹Ù„Ø§Ù†", role: "Ø§Ù„Ù…Ø§Ø³ØªØ±", msg: txt }); }

    function addPost() {
        let p = document.getElementById('post-in').value;
        if(p) {
            db.ref('posts').push({ name: user.name, text: p });
            document.getElementById('post-in').value = "";
        }
    }

    db.ref('posts').on('value', s => {
        let out = "";
        s.forEach(p => { let d = p.val(); out += `<div class="post-card"><b>${d.name}:</b><br>${d.text}</div>`; });
        document.getElementById('diary-area').innerHTML = out;
    });

    function adminAction(target) {
        if(user.role === "Ø§Ù„Ù…Ø§Ø³ØªØ±" && target !== user.name) {
            let action = prompt("1: Ø¬Ø¹Ù„ Ù…Ø´Ø±Ù | 2: Ø·Ø±Ø¯");
            if(action === "1") db.ref('online/'+target+'/role').set('Ù…Ø´Ø±Ù');
            if(action === "2") db.ref('kicked/'+target).set(true);
        }
    }
</script>
</body>
</html>
