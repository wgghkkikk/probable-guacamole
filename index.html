<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
// 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù…Ù…Ù„ÙƒØ© Ø¹Ù„ÙˆØ´
const firebaseConfig = {
    databaseURL: "https://alloush-kingdom-default-rtdb.firebaseio.com"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Ø§Ù„Ø³Ø·Ø± 11: ØªØ¹Ø±ÙŠÙ Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ù„Ùƒ
const KING_NAME = "ðŸ‘‘ Ø¹Ù„ÙˆØ´";

// Ø§Ù„Ø³Ø·Ø± 13: ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ù„ÙƒÙŠ
function sendMsg() {
    let input = document.getElementById('chat-input');
    
    // Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ø£ÙŠ Ø´Ø®Øµ ÙŠØ¯Ø®Ù„
    let username = "Ø²Ø§Ø¦Ø±"; 
    let rank = "Ù…ÙˆØ§Ø·Ù†";

    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø¬Ù‡Ø§Ø² "Ø§Ù„Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´" Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
    if (localStorage.getItem("is_king") === "true") {
        username = KING_NAME;
        rank = "Ù…Ù„Ùƒ Ø§Ù„Ù…Ù…Ù„ÙƒØ©";
    }

    if(input.value.trim() !== "") {
        db.ref("messages").push().set({
            user: username,
            text: input.value,
            rank: rank,
            timestamp: Date.now()
        });
        input.value = "";
    }
}

  // 1. ÙˆØ¸ÙŠÙØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© (ØªÙƒØªØ¨Ù‡Ø§ Ø¨Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
function activateKing() {
    localStorage.setItem("is_king", "true");
    alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø¨Ø¬Ù‡Ø§Ø²Ùƒ ÙŠØ§ Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´! ðŸ‘‘");
}

// 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Øª ÙÙˆØ±Ø§Ù‹ (Ù„Ø§ÙŠÙ) Ù„ÙƒÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ†
db.ref("messages").on("child_added", (snapshot) => {
    let msg = snapshot.val();
    let screen = document.getElementById('chat-screen');
    
    if (screen) {
        screen.innerHTML += `
            <div class="msg" style="border-bottom: 1px solid #1a1a1a; padding: 5px; margin: 5px 0;">
                <span style="color:gold; font-weight:bold;">[${msg.rank}]</span> 
                <strong style="color:#bc13fe;">${msg.user}:</strong> 
                <span style="color:#fff;">${msg.text}</span>
            </div>`;
        
        // Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        screen.scrollTop = screen.scrollHeight;
    }
});
</script>// ÙˆØ¸ÙŠÙØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ØµÙ…Ø© (ØªÙƒØªØ¨Ù‡Ø§ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ Ù„ØªØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ)
function activateKing() {
    localStorage.setItem("is_king", "true");
    alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø¨Ø¬Ù‡Ø§Ø²Ùƒ ÙŠØ§ Ù…Ù„Ùƒ Ø¹Ù„ÙˆØ´! ðŸ‘‘");
}
  // 3. ÙˆØ¸ÙŠÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙˆØ±Ø§Ù‹ (Ù„Ø§ÙŠÙ)
db.ref("messages").on("child_added", (snapshot) => {
    let msg = snapshot.val();
    let screen = document.getElementById('chat-screen');
    
    if (screen) {
        screen.innerHTML += `
            <div class="msg" style="border-bottom: 1px solid #1a1a1a; padding: 5px; margin: 5px 0;">
                <span style="color:gold; font-weight:bold;">[${msg.rank}]</span> 
                <strong style="color:#bc13fe;">${msg.user}:</strong> 
                <span style="color:#fff;">${msg.text}</span>
            </div>`;
        
        // Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        screen.scrollTop = screen.scrollHeight;
    }
});

// Ø¥ØºÙ„Ø§Ù‚ ÙˆØ³Ù… Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
</script>// 3. ÙˆØ¸ÙŠÙØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Øª ÙÙˆØ±Ø§Ù‹ Ù„ÙƒÙ„ Ø§Ù„Ù†Ø§Ø³)
db.ref("messages").on("child_added", (snapshot) => {
    let msg = snapshot.val();
    let screen = document.getElementById('chat-screen');
    
    // ØªØµÙ…ÙŠÙ… Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ©
    screen.innerHTML += `
        <div class="msg" style="border-bottom: 1px solid #1a1a1a; padding: 5px;">
            <span style="color:gold; font-weight:bold;">[${msg.rank}]</span> 
            <strong style="color:#bc13fe;">${msg.user}:</strong> 
            <span style="color:#fff;">${msg.text}</span>
        </div>`;
        
    // Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    screen.scrollTop = screen.scrollHeight;
});
</script>
