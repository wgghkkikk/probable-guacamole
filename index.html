<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø§Ø³ØªØ± RG</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --neon: #00f2ff; --bg: #000; }
        * { box-sizing: border-box; }
        
        /* Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø·ÙˆÙ„ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        html, body { 
            height: 100%; width: 100%; margin: 0; padding: 0; 
            background: #000; color: #fff; font-family: sans-serif; 
            overflow: hidden; position: fixed; /* ÙŠÙ…Ù†Ø¹ Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„Ø´Ø§Ø´Ø© */
        }

        header { 
            height: 50px; background: #111; border-bottom: 2px solid var(--neon);
            display: flex; justify-content: space-between; align-items: center; padding: 0 10px;
            position: absolute; top: 0; width: 100%; z-index: 1000;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø´Ø§Øª */
        #chat-container { 
            position: absolute; top: 50px; left: 0; right: 0;
            /* Ø³Ù†Ø­Ø¯Ø¯ Ø§Ù„Ù€ bottom Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ Ø¨Ø§Ù„Ø£Ø³ÙÙ„ */
            overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px;
        }

        /* Ø®Ø§Ù†Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© - Ø¬Ø¹Ù„Ù†Ø§Ù‡Ø§ ØªØ±ØªÙØ¹ Ø£ÙƒØ«Ø± */
        .input-footer { 
            position: fixed; bottom: 0; left: 0; right: 0; 
            height: 65px; background: #1a1a1a; border-top: 2px solid var(--neon);
            display: flex; align-items: center; padding: 0 10px; gap: 8px; z-index: 9999;
        }

        input { 
            flex: 1; background: #000; color: #fff; border: 1px solid #444; 
            height: 45px; padding: 0 15px; border-radius: 10px; font-size: 16px; outline: none;
        }

        #sendBtn { background: var(--neon); border: none; height: 45px; padding: 0 15px; border-radius: 10px; font-weight: bold; cursor: pointer; color: #000; }

        .msg { background: #111; padding: 8px; border-radius: 8px; border-right: 3px solid var(--neon); word-wrap: break-word; }
        
        /* Ø§Ù„Ø³ØªØ§Ø±Ø§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        .sidebar { position: fixed; top: 50px; bottom: 65px; width: 200px; background: #050505; z-index: 5000; transition: 0.3s; padding: 10px; border: 1px solid #222; display: none; }
        .sidebar.active { display: block; }
        #right-s { right: 0; }
        #left-s { left: 0; }
        .btn-m { background: #222; color: var(--neon); border: 1px solid var(--neon); padding: 5px 10px; border-radius: 5px; font-size: 12px; }
    </style>
</head>
<body>

<header>
    <button class="btn-m" onclick="toggle('right')">Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†</button>
    <b style="color:var(--neon)">MASTER RG</b>
    <button class="btn-m" onclick="toggle('left')">Ø§Ù„Ù…Ù„Ù</button>
</header>

<div id="chat-container"></div>

<div id="right-s" class="sidebar">
    <div style="color:gold">ğŸ‘‘ Ø§Ù„Ù…Ø§Ø³ØªØ± RG</div>
</div>

<div id="left-s" class="sidebar">
    <button class="btn-m" onclick="location.reload()" style="width:100%">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Øª</button>
</div>

<div class="input-footer" id="footer">
    <input type="text" id="msgInp" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§..." autocomplete="off">
    <button id="sendBtn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>

<script>
    const config = { databaseURL: "https://masterchat-f2da9-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const db = firebase.database();

    // --- ÙƒÙˆØ¯ ØªØµØ­ÙŠØ­ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ---
    function fixHeight() {
        const vh = window.innerHeight;
        const footerHeight = document.getElementById('footer').offsetHeight;
        document.getElementById('chat-container').style.bottom = footerHeight + 'px';
    }
    window.addEventListener('resize', fixHeight);
    window.addEventListener('load', fixHeight);
    fixHeight();

    function toggle(id) {
        const el = document.getElementById(id + '-s');
        const isVisible = el.style.display === 'block';
        document.getElementById('right-s').style.display = 'none';
        document.getElementById('left-s').style.display = 'none';
        if (!isVisible) el.style.display = 'block';
    }

    function send() {
        const t = document.getElementById('msgInp').value;
        if(t.trim()) {
            db.ref('messages').push({ u: localStorage.getItem('rg-n') || "Ø§Ù„Ù…Ø§Ø³ØªØ±", t: t });
            document.getElementById('msgInp').value = '';
            // Ø³ÙƒØ±ÙˆÙ„ Ù„Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
            setTimeout(() => {
                const c = document.getElementById('chat-container');
                c.scrollTop = c.scrollHeight;
            }, 200);
        }
    }

    db.ref('messages').limitToLast(20).on('child_added', (snap) => {
        const m = snap.val();
        const div = document.createElement('div');
        div.className = 'msg';
        div.innerHTML = `<b style="color:var(--neon)">${m.u}:</b> ${m.t}`;
        const c = document.getElementById('chat-container');
        c.appendChild(div);
        c.scrollTop = c.scrollHeight;
    });
</script>

</body>
</html>
